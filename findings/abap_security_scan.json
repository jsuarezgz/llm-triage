{
  "scan_metadata": {
    "scanner": {
      "name": "ABAP Security Scanner",
      "version": "1.5.0"
    },
    "scan": {
      "timestamp": "2025-11-12T10:32:18.938474+00:00",
      "target_path": ".\\test-code\\",
      "duration_seconds": 6.81,
      "files_scanned": 411,
      "findings_total": 234
    }
  },
  "statistics": {
    "files": {
      "total_scanned": 411,
      "with_issues": 42
    },
    "findings": {
      "total": 234,
      "by_severity": {
        "HIGH": 219,
        "CRITICAL": 15
      },
      "by_cwe": {
        "CWE-22": 213,
        "CWE-94": 4,
        "CWE-78": 10,
        "CWE-91": 3,
        "CWE-285": 4
      }
    }
  },
  "findings": [
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YAL0029.TXT",
        "line": 679,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "File operation using unvalidated path variable 'ld_path'",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YAL0029.TXT",
        "line": 780,
        "line_content": "DELETE DATASET ld_path.",
        "matched_text": "DELETE DATASET ld_path",
        "context": [
          "   ",
          "         IF sy-subrc EQ 0.",
          "   *       Si la compresion ha ido bien, se borra el fichero original",
          ">>         DELETE DATASET ld_path.",
          "         ENDIF.",
          "       ENDIF.",
          "     ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YAL0029.TXT",
        "line": 710,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "       WHEN rb_ser.",
          "   *     Se carga en el fichero de salida en el servidor",
          ">>       TRANSFER ld_linea TO ld_path.",
          "   ",
          "     ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YAL0029.TXT",
        "line": 738,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "         WHEN rb_ser.",
          "   *       Se carga en el fichero de salida en el servidor",
          ">>         TRANSFER ld_linea TO ld_path.",
          "   ",
          "       ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YAL0029.TXT",
        "line": 809,
        "line_content": "TRANSFER ld_linea TO ld_file_ctl.",
        "matched_text": "TRANSFER ld_linea TO ld_file_ctl",
        "context": [
          "       OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          ">>       TRANSFER ld_linea TO ld_file_ctl.",
          "         CLOSE DATASET ld_file_ctl.",
          "       ENDIF.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YAL0029.TXT",
        "line": 679,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_path FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YAL0029.TXT",
        "line": 806,
        "line_content": "OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_file_ctl FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "   *   Se crea y deposita el fichero CTL en el servidor",
          ">>     OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          "         TRANSFER ld_linea TO ld_file_ctl."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-rfc-injection-001",
      "title": "RFC Injection Vulnerability",
      "message": "RFC call with unvalidated user input may allow remote code execution",
      "severity": "CRITICAL",
      "cwe": "CWE-94",
      "location": {
        "file": "test-code\\YCARGA_PREFACTXLS_F01.TXT",
        "line": 141,
        "line_content": "CALL FUNCTION 'DDIF_FIELDINFO_GET'",
        "matched_text": "CALL FUNCTION 'DDIF_FIELDINFO_GET'",
        "context": [
          "       ENDIF.\" sy-subrc EQ 0.",
          "     ENDIF.\" lt_worksheets IS NOT  INITIAL.",
          "   ",
          ">>   CALL FUNCTION 'DDIF_FIELDINFO_GET'",
          "       EXPORTING",
          "         tabname        = lc_estructura",
          "       TABLES"
        ]
      },
      "security_metadata": {
        "owasp_2021": "A03:2021-Injection",
        "owasp_2017": "A1:2017-Injection",
        "sans_top25_2023": 6,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent RFC injection attacks:\n    - Validate all input parameters before RFC calls\n    - Use allowlist validation for function names and destinations\n    - Sanitize RFC parameters and table data\n    - Implement proper authorization checks before RFC execution\n    - Use constants for RFC function names when possible\n    "
    },
    {
      "rule_id": "abap-os-command-injection-001",
      "title": "OS Command Injection Vulnerability",
      "message": "System command execution with unvalidated user input",
      "severity": "CRITICAL",
      "cwe": "CWE-78",
      "location": {
        "file": "test-code\\YFE1153.TXT",
        "line": 206,
        "line_content": "CALL 'SYSTEM' ID 'COMMAND' FIELD unixcom",
        "matched_text": "CALL 'SYSTEM' ID 'COMMAND' FIELD unixcom",
        "context": [
          "                     RESPECTING BLANKS.",
          "   ",
          "                   \"Lanzar comando unix",
          ">>                 CALL 'SYSTEM' ID 'COMMAND' FIELD unixcom",
          "                     ID 'TAB' FIELD tabl[].",
          "   ",
          "                 ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A03:2021-Injection",
        "owasp_2017": "A1:2017-Injection",
        "sans_top25_2023": 3,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent OS command injection:\n    - Validate and sanitize all command parameters\n    - Use allowlist validation for command arguments  \n    - Avoid dynamic command construction\n    - Use SAP standard functions when possible\n    - Implement proper authorization checks\n    "
    },
    {
      "rule_id": "abap-os-command-injection-001",
      "title": "OS Command Injection Vulnerability",
      "message": "System command execution with unvalidated user input",
      "severity": "CRITICAL",
      "cwe": "CWE-78",
      "location": {
        "file": "test-code\\YFE1153.TXT",
        "line": 295,
        "line_content": "CALL 'SYSTEM' ID 'COMMAND' FIELD unixcom",
        "matched_text": "CALL 'SYSTEM' ID 'COMMAND' FIELD unixcom",
        "context": [
          "                     RESPECTING BLANKS.",
          "   ",
          "                   \"Lanzar comando unix",
          ">>                 CALL 'SYSTEM' ID 'COMMAND' FIELD unixcom",
          "                     ID 'TAB' FIELD tabl[].",
          "   ",
          "                 ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A03:2021-Injection",
        "owasp_2017": "A1:2017-Injection",
        "sans_top25_2023": 3,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent OS command injection:\n    - Validate and sanitize all command parameters\n    - Use allowlist validation for command arguments  \n    - Avoid dynamic command construction\n    - Use SAP standard functions when possible\n    - Implement proper authorization checks\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFE1153.TXT",
        "line": 144,
        "line_content": "READ DATASET name INTO buffer.",
        "matched_text": "READ DATASET name",
        "context": [
          "             ENDIF.",
          "             IF w_ok  = 0.                      \" no existe",
          "               DO.",
          ">>               READ DATASET name INTO buffer.",
          "                 IF sy-subrc <> 0.",
          "                   EXIT.",
          "                 ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFE1153.TXT",
        "line": 239,
        "line_content": "READ DATASET name INTO d_linea1 LENGTH d_len2.",
        "matched_text": "READ DATASET name",
        "context": [
          "               REFRESH d_linea.",
          "               CLEAR d_linea.",
          "               DO.",
          ">>               READ DATASET name INTO d_linea1 LENGTH d_len2.",
          "                 IF sy-subrc = 0.",
          "                   APPEND d_linea1 TO d_linea.",
          "                   d_len1 = d_len1 + d_len2."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFE1153.TXT",
        "line": 125,
        "line_content": "OPEN DATASET name FOR INPUT IN TEXT MODE",
        "matched_text": "OPEN DATASET name FOR INPUT",
        "context": [
          "           IF p_binary IS INITIAL.",
          "   * Se bajar el fichero en formato ASCII.",
          "   * <--- FIN INXX2044  SYD: 247835",
          ">>           OPEN DATASET name FOR INPUT IN TEXT MODE",
          "                         ENCODING NON-UNICODE.",
          "             IF sy-subrc <> 0.",
          "               ADD 1 TO error."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFE1153.TXT",
        "line": 220,
        "line_content": "OPEN DATASET name FOR INPUT IN BINARY MODE.",
        "matched_text": "OPEN DATASET name FOR INPUT",
        "context": [
          "   * ---> INI INXX2044  SYD: 247835",
          "           ELSE.",
          "   * Se bajar el fichero en formato BINARIO.",
          ">>           OPEN DATASET name FOR INPUT IN BINARY MODE.",
          "             IF sy-subrc <> 0.",
          "               ADD 1 TO error.",
          "               WRITE:/ filename, c_error."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFE1249_F01.TXT",
        "line": 790,
        "line_content": "TRANSFER lw_fichero TO p_funix.",
        "matched_text": "TRANSFER lw_fichero TO p_funix",
        "context": [
          "       WRITE lw_fichero-impo7  TO lw_fichero-impo7 .",
          "       WRITE lw_fichero-impo8  TO lw_fichero-impo8 .",
          "   ",
          ">>     TRANSFER lw_fichero TO p_funix.",
          "     ENDLOOP.",
          "     CLOSE DATASET p_funix.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFE1249_F01.TXT",
        "line": 765,
        "line_content": "OPEN DATASET p_funix FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE.",
        "matched_text": "OPEN DATASET p_funix FOR OUTPUT",
        "context": [
          "   ",
          "     CONCATENATE p_funix '.' sy-datum '.' sy-uzeit(4) INTO p_funix.",
          "   ",
          ">>   OPEN DATASET p_funix FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE.",
          "     LOOP AT gi_fichero INTO lw_fichero.",
          "       WRITE lw_fichero-num_reg TO lw_fichero-num_reg .",
          "       WRITE lw_fichero-tipo_acr TO lw_fichero-tipo_acr ."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFI_TIMBMX_ENVIO_PAGOS_F01.TXT",
        "line": 1762,
        "line_content": "TRANSFER ld_linea TO ld_file.",
        "matched_text": "TRANSFER ld_linea TO ld_file",
        "context": [
          "           ENDDO.",
          "         ENDIF.",
          "   ",
          ">>       TRANSFER ld_linea TO ld_file.",
          "       ENDAT.",
          "   ",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFI_TIMBMX_ENVIO_PAGOS_F01.TXT",
        "line": 1942,
        "line_content": "TRANSFER ld_linea TO ld_file.",
        "matched_text": "TRANSFER ld_linea TO ld_file",
        "context": [
          "           ENDDO.",
          "         ENDIF.",
          "   ",
          ">>       TRANSFER ld_linea TO ld_file.",
          "   ",
          "   ",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFI_TIMBMX_ENVIO_PAGOS_F01.TXT",
        "line": 1965,
        "line_content": "TRANSFER ld_linea TO ld_file.",
        "matched_text": "TRANSFER ld_linea TO ld_file",
        "context": [
          "           ENDDO.",
          "         ENDIF.",
          "   ",
          ">>       TRANSFER ld_linea TO ld_file.",
          "   ",
          "   ",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFI_TIMBMX_ENVIO_PAGOS_F01.TXT",
        "line": 2535,
        "line_content": "TRANSFER ld_linea TO ld_file.",
        "matched_text": "TRANSFER ld_linea TO ld_file",
        "context": [
          "           ENDDO.",
          "         ENDIF.",
          "   ",
          ">>       TRANSFER ld_linea TO ld_file.",
          "   ",
          "   ",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFI_TIMBMX_ENVIO_PAGOS_F01.TXT",
        "line": 2557,
        "line_content": "TRANSFER ld_linea TO ld_file.",
        "matched_text": "TRANSFER ld_linea TO ld_file",
        "context": [
          "             ENDDO.",
          "           ENDIF.",
          "   ",
          ">>         TRANSFER ld_linea TO ld_file.",
          "         ENDLOOP.",
          "   ",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFI_TIMBMX_ENVIO_PAGOS_F01.TXT",
        "line": 2589,
        "line_content": "TRANSFER ld_linea TO ld_file.",
        "matched_text": "TRANSFER ld_linea TO ld_file",
        "context": [
          "             ENDDO.",
          "           ENDIF.",
          "   ",
          ">>         TRANSFER ld_linea TO ld_file.",
          "         ENDLOOP.",
          "   ",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFI_TIMBMX_ENVIO_PAGOS_F01.TXT",
        "line": 2611,
        "line_content": "TRANSFER ld_linea TO ld_file.",
        "matched_text": "TRANSFER ld_linea TO ld_file",
        "context": [
          "             ENDDO.",
          "           ENDIF.",
          "   ",
          ">>         TRANSFER ld_linea TO ld_file.",
          "         ENDIF.",
          "   ",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFI_TIMBMX_ENVIO_PAGOS_F01.TXT",
        "line": 2633,
        "line_content": "TRANSFER ld_linea TO ld_file.",
        "matched_text": "TRANSFER ld_linea TO ld_file",
        "context": [
          "             ENDDO.",
          "           ENDIF.",
          "   ",
          ">>         TRANSFER ld_linea TO ld_file.",
          "         ENDIF.",
          "   **Final  insert Timbrados CRP 2.0 - gorodrig - 18/05/2022",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFI_TIMBMX_ENVIO_PAGOS_F01.TXT",
        "line": 1727,
        "line_content": "OPEN DATASET ld_file FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE.",
        "matched_text": "OPEN DATASET ld_file FOR OUTPUT",
        "context": [
          "         CONCATENATE p_dpath p_fname INTO ld_file SEPARATED BY '/'.",
          "   ",
          "   *     Se abre el fichero del servidor",
          ">>       OPEN DATASET ld_file FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE.",
          "         IF sy-subrc NE 0.",
          "           EXIT.",
          "         ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFI_TIMBMX_ENVIO_PAGOS_F01.TXT",
        "line": 2688,
        "line_content": "OPEN DATASET ld_file FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE.",
        "matched_text": "OPEN DATASET ld_file FOR OUTPUT",
        "context": [
          "       REPLACE ALL OCCURRENCES OF '.txt' IN ld_file WITH '.smf'.",
          "   ",
          "   *   Se abre el fichero del servidor",
          ">>     OPEN DATASET ld_file FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE.",
          "       IF sy-subrc EQ 0.",
          "         CLOSE DATASET ld_file.",
          "       ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFI_TIMBMX_RETORNO_PAGOS_F01.TXT",
        "line": 100,
        "line_content": "READ DATASET gd_fich_txt INTO ld_linea.",
        "matched_text": "READ DATASET gd_fich_txt",
        "context": [
          "         OPEN DATASET gd_fich_txt FOR INPUT IN TEXT MODE ENCODING NON-UNICODE.",
          "   ",
          "         IF sy-subrc EQ 0.",
          ">>         READ DATASET gd_fich_txt INTO ld_linea.",
          "           WHILE sy-subrc EQ 0.",
          "             IF ld_linea(1) EQ 'H'.",
          "   *           Linea de cabecera"
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFI_TIMBMX_RETORNO_PAGOS_F01.TXT",
        "line": 145,
        "line_content": "READ DATASET gd_fich_txt INTO ld_linea.",
        "matched_text": "READ DATASET gd_fich_txt",
        "context": [
          "   ",
          "             ENDIF.",
          "   ",
          ">>           READ DATASET gd_fich_txt INTO ld_linea.",
          "           ENDWHILE.",
          "   ",
          "           CLOSE DATASET gd_fich_txt."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFI_TIMBMX_RETORNO_PAGOS_F01.TXT",
        "line": 259,
        "line_content": "READ DATASET pd_fullpath_xml INTO linea_xml.",
        "matched_text": "READ DATASET pd_fullpath_xml",
        "context": [
          "   * Abrir el fichero PDF en modo BIN",
          "     OPEN DATASET pd_fullpath_xml FOR INPUT IN BINARY MODE.",
          "     IF sy-subrc EQ 0.",
          ">>     READ DATASET pd_fullpath_xml INTO linea_xml.",
          "       WHILE sy-subrc EQ 0.",
          "         CONCATENATE full_xml linea_xml INTO full_xml IN BYTE MODE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFI_TIMBMX_RETORNO_PAGOS_F01.TXT",
        "line": 263,
        "line_content": "READ DATASET pd_fullpath_xml INTO linea_xml.",
        "matched_text": "READ DATASET pd_fullpath_xml",
        "context": [
          "       WHILE sy-subrc EQ 0.",
          "         CONCATENATE full_xml linea_xml INTO full_xml IN BYTE MODE.",
          "   ",
          ">>       READ DATASET pd_fullpath_xml INTO linea_xml.",
          "       ENDWHILE.",
          "   ",
          "       CLOSE DATASET pd_fullpath_xml."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFI_TIMBMX_RETORNO_PAGOS_F01.TXT",
        "line": 327,
        "line_content": "READ DATASET pd_fullpath_pdf INTO linea_pdf.",
        "matched_text": "READ DATASET pd_fullpath_pdf",
        "context": [
          "   * Abrir el fichero PDF en modo BIN",
          "     OPEN DATASET pd_fullpath_pdf FOR INPUT IN BINARY MODE.",
          "     IF sy-subrc EQ 0.",
          ">>     READ DATASET pd_fullpath_pdf INTO linea_pdf.",
          "       WHILE sy-subrc EQ 0.",
          "         CONCATENATE pd_full_pdf linea_pdf INTO pd_full_pdf IN BYTE MODE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFI_TIMBMX_RETORNO_PAGOS_F01.TXT",
        "line": 331,
        "line_content": "READ DATASET pd_fullpath_pdf INTO linea_pdf.",
        "matched_text": "READ DATASET pd_fullpath_pdf",
        "context": [
          "       WHILE sy-subrc EQ 0.",
          "         CONCATENATE pd_full_pdf linea_pdf INTO pd_full_pdf IN BYTE MODE.",
          "   ",
          ">>       READ DATASET pd_fullpath_pdf INTO linea_pdf.",
          "       ENDWHILE.",
          "   ",
          "       CLOSE DATASET pd_fullpath_pdf."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFI_TIMBMX_RETORNO_PAGOS_F01.TXT",
        "line": 97,
        "line_content": "OPEN DATASET gd_fich_txt FOR INPUT IN TEXT MODE ENCODING NON-UNICODE.",
        "matched_text": "OPEN DATASET gd_fich_txt FOR INPUT",
        "context": [
          "                INTO gd_fich_txt SEPARATED BY '/'.",
          "   ",
          "   *     Se abre el fichero TXT con la informacin de los anexos a cargar",
          ">>       OPEN DATASET gd_fich_txt FOR INPUT IN TEXT MODE ENCODING NON-UNICODE.",
          "   ",
          "         IF sy-subrc EQ 0.",
          "           READ DATASET gd_fich_txt INTO ld_linea."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFI_TIMBMX_RETORNO_PAGOS_F01.TXT",
        "line": 257,
        "line_content": "OPEN DATASET pd_fullpath_xml FOR INPUT IN BINARY MODE.",
        "matched_text": "OPEN DATASET pd_fullpath_xml FOR INPUT",
        "context": [
          "   ",
          "   ",
          "   * Abrir el fichero PDF en modo BIN",
          ">>   OPEN DATASET pd_fullpath_xml FOR INPUT IN BINARY MODE.",
          "     IF sy-subrc EQ 0.",
          "       READ DATASET pd_fullpath_xml INTO linea_xml.",
          "       WHILE sy-subrc EQ 0."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFI_TIMBMX_RETORNO_PAGOS_F01.TXT",
        "line": 325,
        "line_content": "OPEN DATASET pd_fullpath_pdf FOR INPUT IN BINARY MODE.",
        "matched_text": "OPEN DATASET pd_fullpath_pdf FOR INPUT",
        "context": [
          "   ",
          "   ",
          "   * Abrir el fichero PDF en modo BIN",
          ">>   OPEN DATASET pd_fullpath_pdf FOR INPUT IN BINARY MODE.",
          "     IF sy-subrc EQ 0.",
          "       READ DATASET pd_fullpath_pdf INTO linea_pdf.",
          "       WHILE sy-subrc EQ 0."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00010.TXT",
        "line": 168,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "File operation using unvalidated path variable 'ld_path'",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00010.TXT",
        "line": 271,
        "line_content": "DELETE DATASET ld_path.",
        "matched_text": "DELETE DATASET ld_path",
        "context": [
          "   ",
          "         IF sy-subrc EQ 0.",
          "   *       Si la compresion ha ido bien, se borra el fichero original",
          ">>         DELETE DATASET ld_path.",
          "         ENDIF.",
          "       ENDIF.",
          "     ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00010.TXT",
        "line": 201,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "       WHEN rb_ser.",
          "   *     Se carga en el fichero de salida en el servidor",
          ">>       TRANSFER ld_linea TO ld_path.",
          "   ",
          "     ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00010.TXT",
        "line": 229,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "         WHEN rb_ser.",
          "   *       Se carga en el fichero de salida en el servidor",
          ">>         TRANSFER ld_linea TO ld_path.",
          "   ",
          "       ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00010.TXT",
        "line": 300,
        "line_content": "TRANSFER ld_linea TO ld_file_ctl.",
        "matched_text": "TRANSFER ld_linea TO ld_file_ctl",
        "context": [
          "       OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          ">>       TRANSFER ld_linea TO ld_file_ctl.",
          "         CLOSE DATASET ld_file_ctl.",
          "       ENDIF.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00010.TXT",
        "line": 168,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_path FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00010.TXT",
        "line": 297,
        "line_content": "OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_file_ctl FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "   *   Se crea y deposita el fichero CTL en el servidor",
          ">>     OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          "         TRANSFER ld_linea TO ld_file_ctl."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00013.TXT",
        "line": 172,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "File operation using unvalidated path variable 'ld_path'",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00013.TXT",
        "line": 517,
        "line_content": "DELETE DATASET ld_path.",
        "matched_text": "DELETE DATASET ld_path",
        "context": [
          "   ",
          "         IF sy-subrc EQ 0.",
          "   *       Si la compresion ha ido bien, se borra el fichero original",
          ">>         DELETE DATASET ld_path.",
          "         ENDIF.",
          "       ENDIF.",
          "     ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00013.TXT",
        "line": 320,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "       WHEN rb_ser.",
          "   *     Se carga en el fichero de salida en el servidor",
          ">>       TRANSFER ld_linea TO ld_path.",
          "   ",
          "     ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00013.TXT",
        "line": 475,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "         WHEN rb_ser.",
          "   *       Se carga en el fichero de salida en el servidor",
          ">>         TRANSFER ld_linea TO ld_path.",
          "   ",
          "       ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00013.TXT",
        "line": 546,
        "line_content": "TRANSFER ld_linea TO ld_file_ctl.",
        "matched_text": "TRANSFER ld_linea TO ld_file_ctl",
        "context": [
          "       OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          ">>       TRANSFER ld_linea TO ld_file_ctl.",
          "         CLOSE DATASET ld_file_ctl.",
          "       ENDIF.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00013.TXT",
        "line": 172,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_path FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00013.TXT",
        "line": 543,
        "line_content": "OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_file_ctl FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "   *   Se crea y deposita el fichero CTL en el servidor",
          ">>     OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          "         TRANSFER ld_linea TO ld_file_ctl."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00011.TXT",
        "line": 196,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "File operation using unvalidated path variable 'ld_path'",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00011.TXT",
        "line": 451,
        "line_content": "DELETE DATASET ld_path.",
        "matched_text": "DELETE DATASET ld_path",
        "context": [
          "   ",
          "         IF sy-subrc EQ 0.",
          "   *       Si la compresion ha ido bien, se borra el fichero original",
          ">>         DELETE DATASET ld_path.",
          "         ENDIF.",
          "       ENDIF.",
          "     ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00011.TXT",
        "line": 305,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "       WHEN rb_ser.",
          "   *     Se carga en el fichero de salida en el servidor",
          ">>       TRANSFER ld_linea TO ld_path.",
          "   ",
          "     ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00011.TXT",
        "line": 409,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "         WHEN rb_ser.",
          "   *       Se carga en el fichero de salida en el servidor",
          ">>         TRANSFER ld_linea TO ld_path.",
          "   ",
          "       ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00011.TXT",
        "line": 480,
        "line_content": "TRANSFER ld_linea TO ld_file_ctl.",
        "matched_text": "TRANSFER ld_linea TO ld_file_ctl",
        "context": [
          "       OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          ">>       TRANSFER ld_linea TO ld_file_ctl.",
          "         CLOSE DATASET ld_file_ctl.",
          "       ENDIF.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00011.TXT",
        "line": 196,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_path FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00011.TXT",
        "line": 477,
        "line_content": "OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_file_ctl FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "   *   Se crea y deposita el fichero CTL en el servidor",
          ">>     OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          "         TRANSFER ld_linea TO ld_file_ctl."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00014.TXT",
        "line": 173,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "File operation using unvalidated path variable 'ld_path'",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00014.TXT",
        "line": 264,
        "line_content": "DELETE DATASET ld_path.",
        "matched_text": "DELETE DATASET ld_path",
        "context": [
          "   ",
          "         IF sy-subrc EQ 0.",
          "   *       Si la compresion ha ido bien, se borra el fichero original",
          ">>         DELETE DATASET ld_path.",
          "         ENDIF.",
          "       ENDIF.",
          "     ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00014.TXT",
        "line": 200,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "       WHEN rb_ser.",
          "   *     Se carga en el fichero de salida en el servidor",
          ">>       TRANSFER ld_linea TO ld_path.",
          "   ",
          "     ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00014.TXT",
        "line": 222,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "         WHEN rb_ser.",
          "   *       Se carga en el fichero de salida en el servidor",
          ">>         TRANSFER ld_linea TO ld_path.",
          "   ",
          "       ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00014.TXT",
        "line": 293,
        "line_content": "TRANSFER ld_linea TO ld_file_ctl.",
        "matched_text": "TRANSFER ld_linea TO ld_file_ctl",
        "context": [
          "       OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          ">>       TRANSFER ld_linea TO ld_file_ctl.",
          "         CLOSE DATASET ld_file_ctl.",
          "       ENDIF.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00014.TXT",
        "line": 173,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_path FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00014.TXT",
        "line": 290,
        "line_content": "OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_file_ctl FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "   *   Se crea y deposita el fichero CTL en el servidor",
          ">>     OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          "         TRANSFER ld_linea TO ld_file_ctl."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00015.TXT",
        "line": 195,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "File operation using unvalidated path variable 'ld_path'",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00015.TXT",
        "line": 288,
        "line_content": "DELETE DATASET ld_path.",
        "matched_text": "DELETE DATASET ld_path",
        "context": [
          "   ",
          "         IF sy-subrc EQ 0.",
          "   *       Si la compresion ha ido bien, se borra el fichero original",
          ">>         DELETE DATASET ld_path.",
          "         ENDIF.",
          "       ENDIF.",
          "     ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00015.TXT",
        "line": 223,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "       WHEN rb_ser.",
          "   *     Se carga en el fichero de salida en el servidor",
          ">>       TRANSFER ld_linea TO ld_path.",
          "   ",
          "     ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00015.TXT",
        "line": 246,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "         WHEN rb_ser.",
          "   *       Se carga en el fichero de salida en el servidor",
          ">>         TRANSFER ld_linea TO ld_path.",
          "   ",
          "       ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00015.TXT",
        "line": 317,
        "line_content": "TRANSFER ld_linea TO ld_file_ctl.",
        "matched_text": "TRANSFER ld_linea TO ld_file_ctl",
        "context": [
          "       OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          ">>       TRANSFER ld_linea TO ld_file_ctl.",
          "         CLOSE DATASET ld_file_ctl.",
          "       ENDIF.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00015.TXT",
        "line": 195,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_path FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00015.TXT",
        "line": 314,
        "line_content": "OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_file_ctl FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "   *   Se crea y deposita el fichero CTL en el servidor",
          ">>     OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          "         TRANSFER ld_linea TO ld_file_ctl."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00012.TXT",
        "line": 187,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "File operation using unvalidated path variable 'ld_path'",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00012.TXT",
        "line": 282,
        "line_content": "DELETE DATASET ld_path.",
        "matched_text": "DELETE DATASET ld_path",
        "context": [
          "   ",
          "         IF sy-subrc EQ 0.",
          "   *       Si la compresion ha ido bien, se borra el fichero original",
          ">>         DELETE DATASET ld_path.",
          "         ENDIF.",
          "       ENDIF.",
          "     ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00012.TXT",
        "line": 216,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "       WHEN rb_ser.",
          "   *     Se carga en el fichero de salida en el servidor",
          ">>       TRANSFER ld_linea TO ld_path.",
          "   ",
          "     ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00012.TXT",
        "line": 240,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "         WHEN rb_ser.",
          "   *       Se carga en el fichero de salida en el servidor",
          ">>         TRANSFER ld_linea TO ld_path.",
          "   ",
          "       ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00012.TXT",
        "line": 311,
        "line_content": "TRANSFER ld_linea TO ld_file_ctl.",
        "matched_text": "TRANSFER ld_linea TO ld_file_ctl",
        "context": [
          "       OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          ">>       TRANSFER ld_linea TO ld_file_ctl.",
          "         CLOSE DATASET ld_file_ctl.",
          "       ENDIF.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00012.TXT",
        "line": 187,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_path FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00012.TXT",
        "line": 308,
        "line_content": "OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_file_ctl FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "   *   Se crea y deposita el fichero CTL en el servidor",
          ">>     OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          "         TRANSFER ld_linea TO ld_file_ctl."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00017.TXT",
        "line": 185,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "File operation using unvalidated path variable 'ld_path'",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00017.TXT",
        "line": 296,
        "line_content": "DELETE DATASET ld_path.",
        "matched_text": "DELETE DATASET ld_path",
        "context": [
          "   ",
          "         IF sy-subrc EQ 0.",
          "   *       Si la compresion ha ido bien, se borra el fichero original",
          ">>         DELETE DATASET ld_path.",
          "         ENDIF.",
          "       ENDIF.",
          "     ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00017.TXT",
        "line": 221,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "       WHEN rb_ser.",
          "   *     Se carga en el fichero de salida en el servidor",
          ">>       TRANSFER ld_linea TO ld_path.",
          "   ",
          "     ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00017.TXT",
        "line": 254,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "         WHEN rb_ser.",
          "   *       Se carga en el fichero de salida en el servidor",
          ">>         TRANSFER ld_linea TO ld_path.",
          "   ",
          "       ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00017.TXT",
        "line": 325,
        "line_content": "TRANSFER ld_linea TO ld_file_ctl.",
        "matched_text": "TRANSFER ld_linea TO ld_file_ctl",
        "context": [
          "       OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          ">>       TRANSFER ld_linea TO ld_file_ctl.",
          "         CLOSE DATASET ld_file_ctl.",
          "       ENDIF.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00017.TXT",
        "line": 185,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_path FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00017.TXT",
        "line": 322,
        "line_content": "OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_file_ctl FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "   *   Se crea y deposita el fichero CTL en el servidor",
          ">>     OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          "         TRANSFER ld_linea TO ld_file_ctl."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00016.TXT",
        "line": 231,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "File operation using unvalidated path variable 'ld_path'",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00016.TXT",
        "line": 383,
        "line_content": "DELETE DATASET ld_path.",
        "matched_text": "DELETE DATASET ld_path",
        "context": [
          "   ",
          "         IF sy-subrc EQ 0.",
          "   *       Si la compresion ha ido bien, se borra el fichero original",
          ">>         DELETE DATASET ld_path.",
          "         ENDIF.",
          "       ENDIF.",
          "     ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00016.TXT",
        "line": 287,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "       WHEN rb_ser.",
          "   *     Se carga en el fichero de salida en el servidor",
          ">>       TRANSFER ld_linea TO ld_path.",
          "   ",
          "     ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00016.TXT",
        "line": 341,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "         WHEN rb_ser.",
          "   *       Se carga en el fichero de salida en el servidor",
          ">>         TRANSFER ld_linea TO ld_path.",
          "   ",
          "       ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00016.TXT",
        "line": 412,
        "line_content": "TRANSFER ld_linea TO ld_file_ctl.",
        "matched_text": "TRANSFER ld_linea TO ld_file_ctl",
        "context": [
          "       OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          ">>       TRANSFER ld_linea TO ld_file_ctl.",
          "         CLOSE DATASET ld_file_ctl.",
          "       ENDIF.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00016.TXT",
        "line": 231,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_path FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00016.TXT",
        "line": 409,
        "line_content": "OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_file_ctl FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "   *   Se crea y deposita el fichero CTL en el servidor",
          ">>     OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          "         TRANSFER ld_linea TO ld_file_ctl."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-rfc-injection-001",
      "title": "RFC Injection Vulnerability",
      "message": "RFC call with unvalidated user input may allow remote code execution",
      "severity": "CRITICAL",
      "cwe": "CWE-94",
      "location": {
        "file": "test-code\\YFL00018.TXT",
        "line": 146,
        "line_content": "CALL FUNCTION 'DDIF_FIELDINFO_GET'",
        "matched_text": "CALL FUNCTION 'DDIF_FIELDINFO_GET'",
        "context": [
          "     PERFORM set_filenames.",
          "   ",
          "   * Listado de campos y encabezados de las tablas BKPF y ACDOCA",
          ">>   CALL FUNCTION 'DDIF_FIELDINFO_GET'",
          "       EXPORTING",
          "         tabname        = 'BKPF'",
          "       TABLES"
        ]
      },
      "security_metadata": {
        "owasp_2021": "A03:2021-Injection",
        "owasp_2017": "A1:2017-Injection",
        "sans_top25_2023": 6,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent RFC injection attacks:\n    - Validate all input parameters before RFC calls\n    - Use allowlist validation for function names and destinations\n    - Sanitize RFC parameters and table data\n    - Implement proper authorization checks before RFC execution\n    - Use constants for RFC function names when possible\n    "
    },
    {
      "rule_id": "abap-rfc-injection-001",
      "title": "RFC Injection Vulnerability",
      "message": "RFC call with unvalidated user input may allow remote code execution",
      "severity": "CRITICAL",
      "cwe": "CWE-94",
      "location": {
        "file": "test-code\\YFL00018.TXT",
        "line": 159,
        "line_content": "CALL FUNCTION 'DDIF_FIELDINFO_GET'",
        "matched_text": "CALL FUNCTION 'DDIF_FIELDINFO_GET'",
        "context": [
          "       DELETE gt_catbkpf INDEX 1. \" Eliminar campo Mandante",
          "     ENDIF.",
          "   ",
          ">>   CALL FUNCTION 'DDIF_FIELDINFO_GET'",
          "       EXPORTING",
          "         tabname        = 'ACDOCA'",
          "       TABLES"
        ]
      },
      "security_metadata": {
        "owasp_2021": "A03:2021-Injection",
        "owasp_2017": "A1:2017-Injection",
        "sans_top25_2023": 6,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent RFC injection attacks:\n    - Validate all input parameters before RFC calls\n    - Use allowlist validation for function names and destinations\n    - Sanitize RFC parameters and table data\n    - Implement proper authorization checks before RFC execution\n    - Use constants for RFC function names when possible\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00018.TXT",
        "line": 332,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "File operation using unvalidated path variable 'ld_path'",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00018.TXT",
        "line": 585,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "File operation using unvalidated path variable 'ld_path'",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_bfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00018.TXT",
        "line": 475,
        "line_content": "DELETE DATASET ld_path.",
        "matched_text": "File operation using unvalidated path variable 'ld_path'",
        "context": [
          "   ",
          "         IF sy-subrc EQ 0.",
          "   *       Si la compresion ha ido bien, se borra el fichero original",
          ">>         DELETE DATASET ld_path.",
          "         ENDIF.",
          "       ENDIF.",
          "     ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00018.TXT",
        "line": 475,
        "line_content": "DELETE DATASET ld_path.",
        "matched_text": "DELETE DATASET ld_path",
        "context": [
          "   ",
          "         IF sy-subrc EQ 0.",
          "   *       Si la compresion ha ido bien, se borra el fichero original",
          ">>         DELETE DATASET ld_path.",
          "         ENDIF.",
          "       ENDIF.",
          "     ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00018.TXT",
        "line": 728,
        "line_content": "DELETE DATASET ld_path.",
        "matched_text": "DELETE DATASET ld_path",
        "context": [
          "   ",
          "         IF sy-subrc EQ 0.",
          "   *       Si la compresion ha ido bien, se borra el fichero original",
          ">>         DELETE DATASET ld_path.",
          "         ENDIF.",
          "       ENDIF.",
          "     ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00018.TXT",
        "line": 1108,
        "line_content": "READ DATASET lv_filename INTO ls_data_tab.",
        "matched_text": "READ DATASET lv_filename",
        "context": [
          "           ENDIF.",
          "           IF sy-subrc EQ 0.",
          "             DO.",
          ">>             READ DATASET lv_filename INTO ls_data_tab.",
          "               IF sy-subrc <> 0.",
          "                 EXIT.",
          "               ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00018.TXT",
        "line": 365,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "       WHEN rb_ser.",
          "   *     Se carga en el fichero de salida en el servidor",
          ">>       TRANSFER ld_linea TO ld_path.",
          "   ",
          "     ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00018.TXT",
        "line": 433,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "         WHEN rb_ser.",
          "   *       Se carga en el fichero de salida en el servidor",
          ">>         TRANSFER ld_linea TO ld_path.",
          "   ",
          "       ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00018.TXT",
        "line": 504,
        "line_content": "TRANSFER ld_linea TO ld_file_ctl.",
        "matched_text": "TRANSFER ld_linea TO ld_file_ctl",
        "context": [
          "       OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          ">>       TRANSFER ld_linea TO ld_file_ctl.",
          "         CLOSE DATASET ld_file_ctl.",
          "       ENDIF.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00018.TXT",
        "line": 618,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "       WHEN rb_ser.",
          "   *     Se carga en el fichero de salida en el servidor",
          ">>       TRANSFER ld_linea TO ld_path.",
          "   ",
          "     ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00018.TXT",
        "line": 686,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "         WHEN rb_ser.",
          "   *       Se carga en el fichero de salida en el servidor",
          ">>         TRANSFER ld_linea TO ld_path.",
          "   ",
          "       ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00018.TXT",
        "line": 757,
        "line_content": "TRANSFER ld_linea TO ld_file_ctl.",
        "matched_text": "TRANSFER ld_linea TO ld_file_ctl",
        "context": [
          "       OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          ">>       TRANSFER ld_linea TO ld_file_ctl.",
          "         CLOSE DATASET ld_file_ctl.",
          "       ENDIF.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00018.TXT",
        "line": 332,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_path FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00018.TXT",
        "line": 501,
        "line_content": "OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_file_ctl FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "   *   Se crea y deposita el fichero CTL en el servidor",
          ">>     OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          "         TRANSFER ld_linea TO ld_file_ctl."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00018.TXT",
        "line": 585,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_path FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_bfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00018.TXT",
        "line": 754,
        "line_content": "OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_file_ctl FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "   *   Se crea y deposita el fichero CTL en el servidor",
          ">>     OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          "         TRANSFER ld_linea TO ld_file_ctl."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00018.TXT",
        "line": 1102,
        "line_content": "OPEN DATASET lv_filename FOR INPUT IN BINARY MODE.",
        "matched_text": "OPEN DATASET lv_filename FOR INPUT",
        "context": [
          "           CONCATENATE: lv_dir ls_fileser-name INTO lv_filename.",
          "   ",
          "           IF lv_bin EQ 'X'.",
          ">>           OPEN DATASET lv_filename FOR INPUT IN BINARY MODE.",
          "           ELSEIF lv_text EQ 'X'.",
          "             OPEN DATASET lv_filename FOR INPUT IN TEXT MODE ENCODING DEFAULT.",
          "           ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00018.TXT",
        "line": 1104,
        "line_content": "OPEN DATASET lv_filename FOR INPUT IN TEXT MODE ENCODING DEFAULT.",
        "matched_text": "OPEN DATASET lv_filename FOR INPUT",
        "context": [
          "           IF lv_bin EQ 'X'.",
          "             OPEN DATASET lv_filename FOR INPUT IN BINARY MODE.",
          "           ELSEIF lv_text EQ 'X'.",
          ">>           OPEN DATASET lv_filename FOR INPUT IN TEXT MODE ENCODING DEFAULT.",
          "           ENDIF.",
          "           IF sy-subrc EQ 0.",
          "             DO."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00019.TXT",
        "line": 238,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "File operation using unvalidated path variable 'ld_path'",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00019.TXT",
        "line": 376,
        "line_content": "DELETE DATASET ld_path.",
        "matched_text": "DELETE DATASET ld_path",
        "context": [
          "   ",
          "         IF sy-subrc EQ 0.",
          "   *       Si la compresion ha ido bien, se borra el fichero original",
          ">>         DELETE DATASET ld_path.",
          "         ENDIF.",
          "       ENDIF.",
          "     ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00019.TXT",
        "line": 296,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "       WHEN rb_ser.",
          "   *     Se carga en el fichero de salida en el servidor",
          ">>       TRANSFER ld_linea TO ld_path.",
          "   ",
          "     ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00019.TXT",
        "line": 334,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "         WHEN rb_ser.",
          "   *       Se carga en el fichero de salida en el servidor",
          ">>         TRANSFER ld_linea TO ld_path.",
          "   ",
          "       ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00019.TXT",
        "line": 405,
        "line_content": "TRANSFER ld_linea TO ld_file_ctl.",
        "matched_text": "TRANSFER ld_linea TO ld_file_ctl",
        "context": [
          "       OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          ">>       TRANSFER ld_linea TO ld_file_ctl.",
          "         CLOSE DATASET ld_file_ctl.",
          "       ENDIF.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00019.TXT",
        "line": 238,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_path FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00019.TXT",
        "line": 402,
        "line_content": "OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_file_ctl FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "   *   Se crea y deposita el fichero CTL en el servidor",
          ">>     OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          "         TRANSFER ld_linea TO ld_file_ctl."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00020.TXT",
        "line": 168,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "File operation using unvalidated path variable 'ld_path'",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00020.TXT",
        "line": 261,
        "line_content": "DELETE DATASET ld_path.",
        "matched_text": "DELETE DATASET ld_path",
        "context": [
          "   ",
          "         IF sy-subrc EQ 0.",
          "   *       Si la compresion ha ido bien, se borra el fichero original",
          ">>         DELETE DATASET ld_path.",
          "         ENDIF.",
          "       ENDIF.",
          "     ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00020.TXT",
        "line": 196,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "       WHEN rb_ser.",
          "   *     Se carga en el fichero de salida en el servidor",
          ">>       TRANSFER ld_linea TO ld_path.",
          "   ",
          "     ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00020.TXT",
        "line": 219,
        "line_content": "TRANSFER ld_linea TO ld_path.",
        "matched_text": "TRANSFER ld_linea TO ld_path",
        "context": [
          "   ",
          "         WHEN rb_ser.",
          "   *       Se carga en el fichero de salida en el servidor",
          ">>         TRANSFER ld_linea TO ld_path.",
          "   ",
          "       ENDCASE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00020.TXT",
        "line": 290,
        "line_content": "TRANSFER ld_linea TO ld_file_ctl.",
        "matched_text": "TRANSFER ld_linea TO ld_file_ctl",
        "context": [
          "       OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          ">>       TRANSFER ld_linea TO ld_file_ctl.",
          "         CLOSE DATASET ld_file_ctl.",
          "       ENDIF.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00020.TXT",
        "line": 168,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_path FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL00020.TXT",
        "line": 287,
        "line_content": "OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET ld_file_ctl FOR OUTPUT",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "   *   Se crea y deposita el fichero CTL en el servidor",
          ">>     OPEN DATASET ld_file_ctl FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         CONCATENATE sy-datum sy-uzeit INTO ld_linea.",
          "         TRANSFER ld_linea TO ld_file_ctl."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL0129.TXT",
        "line": 1265,
        "line_content": "TRANSFER ls_pdf_stream_tab TO p_path_u.",
        "matched_text": "TRANSFER ls_pdf_stream_tab TO p_path_u",
        "context": [
          "       OPEN DATASET p_path_u FOR OUTPUT IN BINARY MODE.",
          "       IF sy-subrc EQ 0.",
          "         LOOP AT pdf_stream_tab INTO ls_pdf_stream_tab.",
          ">>         TRANSFER ls_pdf_stream_tab TO p_path_u.",
          "         ENDLOOP.",
          "         CLOSE DATASET p_path_u.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL0129.TXT",
        "line": 1262,
        "line_content": "OPEN DATASET p_path_u FOR OUTPUT IN BINARY MODE.",
        "matched_text": "OPEN DATASET p_path_u FOR OUTPUT",
        "context": [
          "         TABLES",
          "           binary_tab = pdf_stream_tab.",
          "   ",
          ">>     OPEN DATASET p_path_u FOR OUTPUT IN BINARY MODE.",
          "       IF sy-subrc EQ 0.",
          "         LOOP AT pdf_stream_tab INTO ls_pdf_stream_tab.",
          "           TRANSFER ls_pdf_stream_tab TO p_path_u."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL0164.TXT",
        "line": 2985,
        "line_content": "OPEN DATASET p_path_u FOR OUTPUT IN BINARY MODE.",
        "matched_text": "File operation using unvalidated path variable 'p_path_u'",
        "context": [
          "         TABLES",
          "           binary_tab = pdf_stream_tab.",
          "   ",
          ">>     OPEN DATASET p_path_u FOR OUTPUT IN BINARY MODE.",
          "       IF sy-subrc EQ 0.",
          "         LOOP AT pdf_stream_tab INTO ls_pdf_stream_tab.",
          "           TRANSFER ls_pdf_stream_tab TO p_path_u ."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL0164.TXT",
        "line": 3079,
        "line_content": "OPEN DATASET p_path_u FOR OUTPUT IN BINARY MODE.",
        "matched_text": "File operation using unvalidated path variable 'p_path_u'",
        "context": [
          "         TABLES",
          "           binary_tab = pdf_stream_tab.",
          "   ",
          ">>     OPEN DATASET p_path_u FOR OUTPUT IN BINARY MODE.",
          "       IF sy-subrc EQ 0.",
          "         LOOP AT pdf_stream_tab INTO ls_pdf_stream_tab.",
          "           TRANSFER ls_pdf_stream_tab TO p_path_u ."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL0164.TXT",
        "line": 2988,
        "line_content": "TRANSFER ls_pdf_stream_tab TO p_path_u .",
        "matched_text": "TRANSFER ls_pdf_stream_tab TO p_path_u",
        "context": [
          "       OPEN DATASET p_path_u FOR OUTPUT IN BINARY MODE.",
          "       IF sy-subrc EQ 0.",
          "         LOOP AT pdf_stream_tab INTO ls_pdf_stream_tab.",
          ">>         TRANSFER ls_pdf_stream_tab TO p_path_u .",
          "         ENDLOOP.",
          "   ",
          "         CLOSE DATASET p_path_u."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL0164.TXT",
        "line": 3082,
        "line_content": "TRANSFER ls_pdf_stream_tab TO p_path_u .",
        "matched_text": "TRANSFER ls_pdf_stream_tab TO p_path_u",
        "context": [
          "       OPEN DATASET p_path_u FOR OUTPUT IN BINARY MODE.",
          "       IF sy-subrc EQ 0.",
          "         LOOP AT pdf_stream_tab INTO ls_pdf_stream_tab.",
          ">>         TRANSFER ls_pdf_stream_tab TO p_path_u .",
          "         ENDLOOP.",
          "   ",
          "         CLOSE DATASET p_path_u."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL0164.TXT",
        "line": 2985,
        "line_content": "OPEN DATASET p_path_u FOR OUTPUT IN BINARY MODE.",
        "matched_text": "OPEN DATASET p_path_u FOR OUTPUT",
        "context": [
          "         TABLES",
          "           binary_tab = pdf_stream_tab.",
          "   ",
          ">>     OPEN DATASET p_path_u FOR OUTPUT IN BINARY MODE.",
          "       IF sy-subrc EQ 0.",
          "         LOOP AT pdf_stream_tab INTO ls_pdf_stream_tab.",
          "           TRANSFER ls_pdf_stream_tab TO p_path_u ."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFL0164.TXT",
        "line": 3079,
        "line_content": "OPEN DATASET p_path_u FOR OUTPUT IN BINARY MODE.",
        "matched_text": "OPEN DATASET p_path_u FOR OUTPUT",
        "context": [
          "         TABLES",
          "           binary_tab = pdf_stream_tab.",
          "   ",
          ">>     OPEN DATASET p_path_u FOR OUTPUT IN BINARY MODE.",
          "       IF sy-subrc EQ 0.",
          "         LOOP AT pdf_stream_tab INTO ls_pdf_stream_tab.",
          "           TRANSFER ls_pdf_stream_tab TO p_path_u ."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFP0041.TXT",
        "line": 1340,
        "line_content": "TRANSFER bextok TO output-ok.",
        "matched_text": "TRANSFER bextok TO output",
        "context": [
          "   ",
          "   ",
          "     LOOP AT bextok.",
          ">>     TRANSFER bextok TO output-ok.",
          "       TRANSFER bextok TO output-ok1.",
          "     ENDLOOP.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFP0041.TXT",
        "line": 1341,
        "line_content": "TRANSFER bextok TO output-ok1.",
        "matched_text": "TRANSFER bextok TO output",
        "context": [
          "   ",
          "     LOOP AT bextok.",
          "       TRANSFER bextok TO output-ok.",
          ">>     TRANSFER bextok TO output-ok1.",
          "     ENDLOOP.",
          "   ",
          "   ENDFORM.                    \"DOWNLOAD_EXTOK"
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFP0041.TXT",
        "line": 1370,
        "line_content": "TRANSFER bextokme TO output-okme.",
        "matched_text": "TRANSFER bextokme TO output",
        "context": [
          "   ",
          "   ",
          "     LOOP AT bextokme.",
          ">>     TRANSFER bextokme TO output-okme.",
          "       TRANSFER bextokme TO output-ok1me.",
          "     ENDLOOP.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFP0041.TXT",
        "line": 1371,
        "line_content": "TRANSFER bextokme TO output-ok1me.",
        "matched_text": "TRANSFER bextokme TO output",
        "context": [
          "   ",
          "     LOOP AT bextokme.",
          "       TRANSFER bextokme TO output-okme.",
          ">>     TRANSFER bextokme TO output-ok1me.",
          "     ENDLOOP.",
          "   ",
          "   ENDFORM.                    \" DOWNLOAD_EXTOKME"
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFP0041.TXT",
        "line": 2374,
        "line_content": "TRANSFER bextnok TO p_output_nok.",
        "matched_text": "TRANSFER bextnok TO p_output_nok",
        "context": [
          "     OPEN DATASET p_output_nok FOR OUTPUT IN TEXT MODE ENCODING UTF-8. \" with byte-order mark. \"ENCODING NON-UNICODE.",
          "   ",
          "     LOOP AT bextnok.",
          ">>     TRANSFER bextnok TO p_output_nok.",
          "     ENDLOOP.",
          "   ENDFORM.",
          "   *&---------------------------------------------------------------------*"
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFP0041.TXT",
        "line": 2389,
        "line_content": "TRANSFER tblog TO p_output_log.",
        "matched_text": "TRANSFER tblog TO p_output_log",
        "context": [
          "     OPEN DATASET p_output_log FOR OUTPUT IN TEXT MODE ENCODING UTF-8. \" with byte-order mark. \"ENCODING NON-UNICODE.",
          "   ",
          "     LOOP AT tblog.",
          ">>     TRANSFER tblog TO p_output_log.",
          "     ENDLOOP.",
          "   ENDFORM.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFP0041.TXT",
        "line": 2371,
        "line_content": "OPEN DATASET p_output_nok FOR OUTPUT IN TEXT MODE ENCODING UTF-8. \" with byte-order mark. \"ENCODING NON-UNICODE.",
        "matched_text": "OPEN DATASET p_output_nok FOR OUTPUT",
        "context": [
          "   *&---------------------------------------------------------------------*",
          "   FORM download_extnok_server  USING    p_output_nok.",
          "   ",
          ">>   OPEN DATASET p_output_nok FOR OUTPUT IN TEXT MODE ENCODING UTF-8. \" with byte-order mark. \"ENCODING NON-UNICODE.",
          "   ",
          "     LOOP AT bextnok.",
          "       TRANSFER bextnok TO p_output_nok."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFP0041.TXT",
        "line": 2386,
        "line_content": "OPEN DATASET p_output_log FOR OUTPUT IN TEXT MODE ENCODING UTF-8. \" with byte-order mark. \"ENCODING NON-UNICODE.",
        "matched_text": "OPEN DATASET p_output_log FOR OUTPUT",
        "context": [
          "   *&---------------------------------------------------------------------*",
          "   FORM download_log_server  USING    p_output_log.",
          "   ",
          ">>   OPEN DATASET p_output_log FOR OUTPUT IN TEXT MODE ENCODING UTF-8. \" with byte-order mark. \"ENCODING NON-UNICODE.",
          "   ",
          "     LOOP AT tblog.",
          "       TRANSFER tblog TO p_output_log."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFP1241N_F01.TXT",
        "line": 234,
        "line_content": "READ DATASET uv_filesr INTO ls_fichero.",
        "matched_text": "READ DATASET uv_filesr",
        "context": [
          "       MESSAGE e000(ylpc_f3) WITH TEXT-001. \"Error al abrir el fichero.",
          "     ENDIF.",
          "   ",
          ">>   READ DATASET uv_filesr INTO ls_fichero.",
          "     lv_subrc = sy-subrc.",
          "   *    Leemos todos los registros del fichero",
          "     WHILE lv_subrc = 0."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFP1241N_F01.TXT",
        "line": 240,
        "line_content": "READ DATASET uv_filesr INTO ls_fichero.",
        "matched_text": "READ DATASET uv_filesr",
        "context": [
          "     WHILE lv_subrc = 0.",
          "       APPEND ls_fichero TO gt_input.",
          "       CLEAR ls_fichero.",
          ">>     READ DATASET uv_filesr INTO ls_fichero.",
          "       lv_subrc = sy-subrc.",
          "     ENDWHILE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFP1241N_F01.TXT",
        "line": 795,
        "line_content": "READ DATASET uv_filesr INTO ls_fichero.",
        "matched_text": "READ DATASET uv_filesr",
        "context": [
          "       MESSAGE e000(ylpc_f3) WITH TEXT-001. \"Error al abrir el fichero.",
          "     ENDIF.",
          "   ",
          ">>   READ DATASET uv_filesr INTO ls_fichero.",
          "     lv_subrc = sy-subrc.",
          "   *    Leemos todos los registros del fichero",
          "     WHILE lv_subrc = 0."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFP1241N_F01.TXT",
        "line": 801,
        "line_content": "READ DATASET uv_filesr INTO ls_fichero.",
        "matched_text": "READ DATASET uv_filesr",
        "context": [
          "     WHILE lv_subrc = 0.",
          "       APPEND ls_fichero TO gt_input_cr.",
          "       CLEAR ls_fichero.",
          ">>     READ DATASET uv_filesr INTO ls_fichero.",
          "       lv_subrc = sy-subrc.",
          "     ENDWHILE.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFP1241N_F01.TXT",
        "line": 229,
        "line_content": "OPEN DATASET uv_filesr FOR INPUT IN TEXT MODE ENCODING NON-UNICODE.",
        "matched_text": "OPEN DATASET uv_filesr FOR INPUT",
        "context": [
          "     DATA: ls_fichero TYPE yfp1241n_fichero,",
          "           lv_subrc   TYPE sysubrc.",
          "   ",
          ">>   OPEN DATASET uv_filesr FOR INPUT IN TEXT MODE ENCODING NON-UNICODE.",
          "     IF sy-subrc NE 0.",
          "       MESSAGE e000(ylpc_f3) WITH TEXT-001. \"Error al abrir el fichero.",
          "     ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFP1241N_F01.TXT",
        "line": 790,
        "line_content": "OPEN DATASET uv_filesr FOR INPUT IN TEXT MODE ENCODING NON-UNICODE.",
        "matched_text": "OPEN DATASET uv_filesr FOR INPUT",
        "context": [
          "     DATA: ls_fichero TYPE yfp1241_fichero,",
          "           lv_subrc   TYPE sysubrc.",
          "   ",
          ">>   OPEN DATASET uv_filesr FOR INPUT IN TEXT MODE ENCODING NON-UNICODE.",
          "     IF sy-subrc NE 0.",
          "       MESSAGE e000(ylpc_f3) WITH TEXT-001. \"Error al abrir el fichero.",
          "     ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFP1241_F01.TXT",
        "line": 51,
        "line_content": "READ DATASET p_un_fil INTO wa_fichero.",
        "matched_text": "READ DATASET p_un_fil",
        "context": [
          "       CLEAR p_error.",
          "   ",
          "       OPEN DATASET p_un_fil FOR INPUT IN TEXT MODE ENCODING NON-UNICODE.",
          ">>     READ DATASET p_un_fil INTO wa_fichero.",
          "       subrc = sy-subrc.",
          "   *    Leemos todos los registros del fichero",
          "       WHILE subrc = 0."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFP1241_F01.TXT",
        "line": 57,
        "line_content": "READ DATASET p_un_fil INTO wa_fichero.",
        "matched_text": "READ DATASET p_un_fil",
        "context": [
          "       WHILE subrc = 0.",
          "         APPEND wa_fichero TO i_fichero.",
          "         CLEAR wa_fichero.",
          ">>       READ DATASET p_un_fil INTO wa_fichero.",
          "         subrc = sy-subrc.",
          "       ENDWHILE.",
          "       CLOSE DATASET p_un_fil."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFP1241_F01.TXT",
        "line": 50,
        "line_content": "OPEN DATASET p_un_fil FOR INPUT IN TEXT MODE ENCODING NON-UNICODE.",
        "matched_text": "OPEN DATASET p_un_fil FOR INPUT",
        "context": [
          "   ",
          "       CLEAR p_error.",
          "   ",
          ">>     OPEN DATASET p_un_fil FOR INPUT IN TEXT MODE ENCODING NON-UNICODE.",
          "       READ DATASET p_un_fil INTO wa_fichero.",
          "       subrc = sy-subrc.",
          "   *    Leemos todos los registros del fichero"
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YFP1241_F01.TXT",
        "line": 2038,
        "line_content": "OPEN DATASET p_un_fil FOR INPUT IN TEXT MODE ENCODING NON-UNICODE.",
        "matched_text": "OPEN DATASET p_un_fil FOR INPUT",
        "context": [
          "   *  *    ENDIF.",
          "       ELSE.",
          "   *  En caso de fichero UNIX, ha de existir",
          ">>       OPEN DATASET p_un_fil FOR INPUT IN TEXT MODE ENCODING NON-UNICODE.",
          "         IF sy-subrc NE 0.",
          "           MESSAGE TEXT-e04 TYPE 'E'.",
          "           p_doc_error = 'X'."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-rfc-injection-001",
      "title": "RFC Injection Vulnerability",
      "message": "RFC call with unvalidated user input may allow remote code execution",
      "severity": "CRITICAL",
      "cwe": "CWE-94",
      "location": {
        "file": "test-code\\YFP9101_F01.TXT",
        "line": 9749,
        "line_content": "CALL FUNCTION 'DDIF_FIELDINFO_GET'",
        "matched_text": "CALL FUNCTION 'DDIF_FIELDINFO_GET'",
        "context": [
          "   ",
          "     DATA: lt_dfies_tab  TYPE dfies OCCURS 0 WITH HEADER LINE.",
          "   ",
          ">>   CALL FUNCTION 'DDIF_FIELDINFO_GET'",
          "       EXPORTING",
          "         tabname        = p_tabla",
          "         fieldname      = p_fieldname"
        ]
      },
      "security_metadata": {
        "owasp_2021": "A03:2021-Injection",
        "owasp_2017": "A1:2017-Injection",
        "sans_top25_2023": 6,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent RFC injection attacks:\n    - Validate all input parameters before RFC calls\n    - Use allowlist validation for function names and destinations\n    - Sanitize RFC parameters and table data\n    - Implement proper authorization checks before RFC execution\n    - Use constants for RFC function names when possible\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YKE1055.TXT",
        "line": 947,
        "line_content": "TRANSFER l_hdr TO gv_filename.",
        "matched_text": "TRANSFER l_hdr TO gv_filename",
        "context": [
          "                   'Amo acumulada'",
          "                   'ValCont. act'",
          "                   INTO l_hdr SEPARATED BY '|'.",
          ">>     TRANSFER l_hdr TO gv_filename.",
          "       LOOP AT it_csv_table INTO l_hdr.",
          "         TRANSFER l_hdr TO gv_filename.",
          "       ENDLOOP."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YKE1055.TXT",
        "line": 949,
        "line_content": "TRANSFER l_hdr TO gv_filename.",
        "matched_text": "TRANSFER l_hdr TO gv_filename",
        "context": [
          "                   INTO l_hdr SEPARATED BY '|'.",
          "       TRANSFER l_hdr TO gv_filename.",
          "       LOOP AT it_csv_table INTO l_hdr.",
          ">>       TRANSFER l_hdr TO gv_filename.",
          "       ENDLOOP.",
          "     ENDIF.",
          "     CLOSE DATASET gv_filename."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YKE1055.TXT",
        "line": 917,
        "line_content": "OPEN DATASET gv_filename FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE",
        "matched_text": "OPEN DATASET gv_filename FOR OUTPUT",
        "context": [
          "       EXCEPTIONS",
          "         conversion_failed    = 1",
          "         OTHERS               = 2.",
          ">>   OPEN DATASET gv_filename FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE",
          "   * INXX2291 - Ini",
          "                                         IGNORING CONVERSION ERRORS.",
          "   * INXX2291 - Fin"
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YKE1050.TXT",
        "line": 649,
        "line_content": "TRANSFER lv_line TO lv_fichero.",
        "matched_text": "TRANSFER lv_line TO lv_fichero",
        "context": [
          "                 'Descripcin PeP|'(010)    &&",
          "                 'Importe ML'(011)          .",
          "   ",
          ">>     TRANSFER lv_line TO lv_fichero.",
          "       CLEAR lv_line.",
          "   ",
          "       LOOP AT lt_data ASSIGNING <fs_data>."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YKE1050.TXT",
        "line": 671,
        "line_content": "TRANSFER lv_line TO lv_fichero.",
        "matched_text": "TRANSFER lv_line TO lv_fichero",
        "context": [
          "                   |{ <fs_data>-post1 }\\|| &&",
          "                   |{ <fs_data>-wkgbtr }| .",
          "   ",
          ">>       TRANSFER lv_line TO lv_fichero.",
          "         CLEAR lv_line.",
          "       ENDLOOP.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YKE1050.TXT",
        "line": 633,
        "line_content": "OPEN DATASET lv_fichero FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE",
        "matched_text": "OPEN DATASET lv_fichero FOR OUTPUT",
        "context": [
          "   ",
          "     DELETE ADJACENT DUPLICATES FROM lt_data COMPARING nukey.",
          "   ",
          ">>   OPEN DATASET lv_fichero FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE",
          "                                        IGNORING CONVERSION ERRORS.",
          "   ",
          "     IF sy-subrc EQ 0."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YKE1060_F01.TXT",
        "line": 870,
        "line_content": "TRANSFER lv_header TO lv_file.",
        "matched_text": "TRANSFER lv_header TO lv_file",
        "context": [
          "                   TEXT-h23  \"Unidades Fsicas: campos descriptivos",
          "              INTO lv_header SEPARATED BY '|'.",
          "   ",
          ">>     TRANSFER lv_header TO lv_file.",
          "   ",
          "       LOOP AT gt_output ASSIGNING <lfs_output>.",
          "         lv_importe = <lfs_output>-importe."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YKE1060_F01.TXT",
        "line": 924,
        "line_content": "TRANSFER lv_line TO lv_file.",
        "matched_text": "TRANSFER lv_line TO lv_file",
        "context": [
          "         CONCATENATE lv_line '|'",
          "                INTO lv_line. \"fin de la lnea",
          "   ",
          ">>       TRANSFER lv_line TO lv_file.",
          "   ",
          "         CLEAR: lv_importe,",
          "                lv_cantidad,"
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YKE1060_F01.TXT",
        "line": 841,
        "line_content": "OPEN DATASET lv_file FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE",
        "matched_text": "OPEN DATASET lv_file FOR OUTPUT",
        "context": [
          "     CONCATENATE p_path '/' lv_filename '.txt'",
          "            INTO lv_file.",
          "   ",
          ">>   OPEN DATASET lv_file FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE",
          "                          IGNORING CONVERSION ERRORS.",
          "     IF sy-subrc EQ 0.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-os-command-injection-001",
      "title": "OS Command Injection Vulnerability",
      "message": "System command execution with unvalidated user input",
      "severity": "CRITICAL",
      "cwe": "CWE-78",
      "location": {
        "file": "test-code\\YKE1065.TXT",
        "line": 63,
        "line_content": "CALL 'SYSTEM' ID 'COMMAND' FIELD gv_command",
        "matched_text": "CALL 'SYSTEM' ID 'COMMAND' FIELD gv_command",
        "context": [
          "   ",
          "     write: gv_command.",
          "   ",
          ">>   CALL 'SYSTEM' ID 'COMMAND' FIELD gv_command",
          "                   ID 'TAB'     FIELD gt_tab.",
          "     write: /.",
          "     loop at gt_tab INTO wgt_tab."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A03:2021-Injection",
        "owasp_2017": "A1:2017-Injection",
        "sans_top25_2023": 3,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent OS command injection:\n    - Validate and sanitize all command parameters\n    - Use allowlist validation for command arguments  \n    - Avoid dynamic command construction\n    - Use SAP standard functions when possible\n    - Implement proper authorization checks\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YLPC_F3_PA_FI_RETITBMS_FORM.TXT",
        "line": 972,
        "line_content": "TRANSFER lv_out TO lv_fichero.",
        "matched_text": "TRANSFER lv_out TO lv_fichero",
        "context": [
          "               CONCATENATE lv_out <fs> INTO lv_out SEPARATED BY lv_htab_c.",
          "             ENDIF.",
          "           ELSE.",
          ">>           TRANSFER lv_out TO lv_fichero.",
          "             EXIT.",
          "           ENDIF.",
          "         ENDDO."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YLPC_F3_PA_FI_RETITBMS_FORM.TXT",
        "line": 953,
        "line_content": "OPEN DATASET lv_fichero FOR OUTPUT IN TEXT MODE ENCODING DEFAULT.",
        "matched_text": "OPEN DATASET lv_fichero FOR OUTPUT",
        "context": [
          "     TRANSLATE lv_fichero TO LOWER CASE.",
          "   ",
          "     CONCATENATE 'Datos descargados con xito a'(s01) lv_fichero INTO lv_success SEPARATED BY space.",
          ">>   OPEN DATASET lv_fichero FOR OUTPUT IN TEXT MODE ENCODING DEFAULT.",
          "   ",
          "     IF sy-subrc NE 0.",
          "       MESSAGE ID 'YL' TYPE gc_s NUMBER 016 WITH TEXT-e04 sy-subrc."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-os-command-injection-001",
      "title": "OS Command Injection Vulnerability",
      "message": "System command execution with unvalidated user input",
      "severity": "CRITICAL",
      "cwe": "CWE-78",
      "location": {
        "file": "test-code\\YOT00001.TXT",
        "line": 69,
        "line_content": "call 'SYSTEM' id 'COMMAND' field w_comando_unix.",
        "matched_text": "call 'SYSTEM' id 'COMMAND' field w_comando_unix",
        "context": [
          "       endif.",
          "       concatenate 'cat' fileorig '>' filedest",
          "          into w_comando_unix separated by space.",
          ">>     call 'SYSTEM' id 'COMMAND' field w_comando_unix.",
          "       data: wfin(1) value ''.",
          "       while wfin = ''.",
          "         open dataset filedest for output in TEXT MODE ENCODING DEFAULT."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A03:2021-Injection",
        "owasp_2017": "A1:2017-Injection",
        "sans_top25_2023": 3,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent OS command injection:\n    - Validate and sanitize all command parameters\n    - Use allowlist validation for command arguments  \n    - Avoid dynamic command construction\n    - Use SAP standard functions when possible\n    - Implement proper authorization checks\n    "
    },
    {
      "rule_id": "abap-os-command-injection-001",
      "title": "OS Command Injection Vulnerability",
      "message": "System command execution with unvalidated user input",
      "severity": "CRITICAL",
      "cwe": "CWE-78",
      "location": {
        "file": "test-code\\YOT00001.TXT",
        "line": 171,
        "line_content": "call 'SYSTEM' id 'COMMAND' field w_comando_unix.",
        "matched_text": "call 'SYSTEM' id 'COMMAND' field w_comando_unix",
        "context": [
          "              into w_comando_unix separated by space.",
          "         endif.",
          "   ",
          ">>       call 'SYSTEM' id 'COMMAND' field w_comando_unix.",
          "       endif.",
          "       format color col_normal.",
          "       total_len = total_len + file-len."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A03:2021-Injection",
        "owasp_2017": "A1:2017-Injection",
        "sans_top25_2023": 3,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent OS command injection:\n    - Validate and sanitize all command parameters\n    - Use allowlist validation for command arguments  \n    - Avoid dynamic command construction\n    - Use SAP standard functions when possible\n    - Implement proper authorization checks\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YOT00001.TXT",
        "line": 72,
        "line_content": "open dataset filedest for output in TEXT MODE ENCODING DEFAULT.",
        "matched_text": "open dataset filedest for output",
        "context": [
          "       call 'SYSTEM' id 'COMMAND' field w_comando_unix.",
          "       data: wfin(1) value ''.",
          "       while wfin = ''.",
          ">>       open dataset filedest for output in TEXT MODE ENCODING DEFAULT.",
          "         if sy-subrc = 0.",
          "           wfin = 'X'.",
          "         endif."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-xml-injection-001",
      "title": "XML Injection Vulnerability",
      "message": "CALL TRANSFORMATION with unvalidated input may lead to XML injection",
      "severity": "HIGH",
      "cwe": "CWE-91",
      "location": {
        "file": "test-code\\YRPFIGLMX_EACCOUNTING_CP_MAIN.TXT",
        "line": 275,
        "line_content": "CALL TRANSFORMATION figlmx_header",
        "matched_text": "CALL TRANSFORMATION",
        "context": [
          "   ",
          "   *XML for header",
          "       CLEAR gv_xml_output.",
          ">>     CALL TRANSFORMATION figlmx_header",
          "            SOURCE header = gs_header",
          "            RESULT XML     gv_xml_output.",
          "       CLEAR gv_len."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A03:2021-Injection",
        "owasp_2017": null,
        "sans_top25_2023": null,
        "confidence": "MEDIUM"
      },
      "remediation": "\n    Validate XML input before transformation:\n    - Sanitize user input before XML processing\n    - Use allowlist validation for XML elements\n    - Consider using JSON instead of XML for user data\n    "
    },
    {
      "rule_id": "abap-xml-injection-001",
      "title": "XML Injection Vulnerability",
      "message": "CALL TRANSFORMATION with unvalidated input may lead to XML injection",
      "severity": "HIGH",
      "cwe": "CWE-91",
      "location": {
        "file": "test-code\\YRPFIGLMX_EACCOUNTING_CP_MAIN.TXT",
        "line": 417,
        "line_content": "CALL TRANSFORMATION figlmx_account",
        "matched_text": "CALL TRANSFORMATION",
        "context": [
          "       IF gt_outtab IS NOT INITIAL.",
          "         SORT gt_outtab BY figlmx_code figlmx_acctno.",
          "         CLEAR gv_xml_output.",
          ">>       CALL TRANSFORMATION figlmx_account",
          "              SOURCE account = gt_outtab",
          "              RESULT XML     gv_xml_output.",
          "         CLEAR gv_len."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A03:2021-Injection",
        "owasp_2017": null,
        "sans_top25_2023": null,
        "confidence": "MEDIUM"
      },
      "remediation": "\n    Validate XML input before transformation:\n    - Sanitize user input before XML processing\n    - Use allowlist validation for XML elements\n    - Consider using JSON instead of XML for user data\n    "
    },
    {
      "rule_id": "abap-xml-injection-001",
      "title": "XML Injection Vulnerability",
      "message": "CALL TRANSFORMATION with unvalidated input may lead to XML injection",
      "severity": "HIGH",
      "cwe": "CWE-91",
      "location": {
        "file": "test-code\\YRPFIGLMX_EACCOUNTING_CP_MAIN.TXT",
        "line": 873,
        "line_content": "CALL TRANSFORMATION figlmx_balance",
        "matched_text": "CALL TRANSFORMATION",
        "context": [
          "         ENDIF.",
          "   ",
          "         CLEAR gv_xml_output.",
          ">>       CALL TRANSFORMATION figlmx_balance",
          "              SOURCE balance = gt_baltab",
          "              RESULT XML     gv_xml_output.",
          "         CLEAR gv_len."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A03:2021-Injection",
        "owasp_2017": null,
        "sans_top25_2023": null,
        "confidence": "MEDIUM"
      },
      "remediation": "\n    Validate XML input before transformation:\n    - Sanitize user input before XML processing\n    - Use allowlist validation for XML elements\n    - Consider using JSON instead of XML for user data\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YRPFIGLMX_EACCOUNTING_CP_MAIN.TXT",
        "line": 309,
        "line_content": "TRANSFER gv_xstr_master TO p_path.",
        "matched_text": "TRANSFER gv_xstr_master TO p_path",
        "context": [
          "   *    Transfer header details to file path",
          "       IF gv_is_unicode EQ 'X'.",
          "         PERFORM convert_xml_unicode_to_xstr CHANGING gv_xml_output.",
          ">>       TRANSFER gv_xstr_master TO p_path.",
          "       ELSE.",
          "         TRANSFER gv_xml_output TO p_path.",
          "       ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YRPFIGLMX_EACCOUNTING_CP_MAIN.TXT",
        "line": 311,
        "line_content": "TRANSFER gv_xml_output TO p_path.",
        "matched_text": "TRANSFER gv_xml_output TO p_path",
        "context": [
          "         PERFORM convert_xml_unicode_to_xstr CHANGING gv_xml_output.",
          "         TRANSFER gv_xstr_master TO p_path.",
          "       ELSE.",
          ">>       TRANSFER gv_xml_output TO p_path.",
          "       ENDIF.",
          "   ",
          "       SELECT * FROM fagl_011qt INTO TABLE gt_technode WHERE versn = p_fsv."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YRPFIGLMX_EACCOUNTING_CP_MAIN.TXT",
        "line": 433,
        "line_content": "TRANSFER gv_xstr_master TO p_path.",
        "matched_text": "TRANSFER gv_xstr_master TO p_path",
        "context": [
          "   *      Transfer Account details to file path",
          "         IF gv_is_unicode EQ 'X'.",
          "           PERFORM convert_xml_unicode_to_xstr CHANGING gv_xml_output.",
          ">>         TRANSFER gv_xstr_master TO p_path.",
          "         ELSE.",
          "           TRANSFER gv_xml_output TO p_path.",
          "         ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YRPFIGLMX_EACCOUNTING_CP_MAIN.TXT",
        "line": 435,
        "line_content": "TRANSFER gv_xml_output TO p_path.",
        "matched_text": "TRANSFER gv_xml_output TO p_path",
        "context": [
          "           PERFORM convert_xml_unicode_to_xstr CHANGING gv_xml_output.",
          "           TRANSFER gv_xstr_master TO p_path.",
          "         ELSE.",
          ">>         TRANSFER gv_xml_output TO p_path.",
          "         ENDIF.",
          "       ENDIF.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YRPFIGLMX_EACCOUNTING_CP_MAIN.TXT",
        "line": 889,
        "line_content": "TRANSFER gv_xstr_master TO p_path.",
        "matched_text": "TRANSFER gv_xstr_master TO p_path",
        "context": [
          "   *      Transfer Balance details to file path",
          "         IF gv_is_unicode EQ 'X'.",
          "           PERFORM convert_xml_unicode_to_xstr CHANGING gv_xml_output.",
          ">>         TRANSFER gv_xstr_master TO p_path.",
          "         ELSE.",
          "           TRANSFER gv_xml_output TO p_path.",
          "         ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YRPFIGLMX_EACCOUNTING_CP_MAIN.TXT",
        "line": 891,
        "line_content": "TRANSFER gv_xml_output TO p_path.",
        "matched_text": "TRANSFER gv_xml_output TO p_path",
        "context": [
          "           PERFORM convert_xml_unicode_to_xstr CHANGING gv_xml_output.",
          "           TRANSFER gv_xstr_master TO p_path.",
          "         ELSE.",
          ">>         TRANSFER gv_xml_output TO p_path.",
          "         ENDIF.",
          "       ENDIF.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YRPFIGLMX_EACCOUNTING_CP_MAIN.TXT",
        "line": 267,
        "line_content": "OPEN DATASET p_path FOR OUTPUT MESSAGE gv_msg IN BINARY MODE.",
        "matched_text": "OPEN DATASET p_path FOR OUTPUT",
        "context": [
          "         CLEAR gv_filename.",
          "       ENDIF.",
          "   ",
          ">>     OPEN DATASET p_path FOR OUTPUT MESSAGE gv_msg IN BINARY MODE.",
          "       IF sy-subrc <> 0.",
          "         WRITE / gv_msg.",
          "         EXIT."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-os-command-injection-001",
      "title": "OS Command Injection Vulnerability",
      "message": "System command execution with unvalidated user input",
      "severity": "CRITICAL",
      "cwe": "CWE-78",
      "location": {
        "file": "test-code\\YSU_DOWN_INFO.TXT",
        "line": 912,
        "line_content": "CALL 'SYSTEM' ID 'COMMAND' FIELD w_comando_unix.",
        "matched_text": "CALL 'SYSTEM' ID 'COMMAND' FIELD w_comando_unix",
        "context": [
          "           WHEN 'COPY'.",
          "             CONCATENATE 'cp' fileorig filedest",
          "                   INTO w_comando_unix SEPARATED BY space.",
          ">>           CALL 'SYSTEM' ID 'COMMAND' FIELD w_comando_unix.",
          "           WHEN 'MOVE'.",
          "             CONCATENATE 'mv' fileorig filedest",
          "                   INTO w_comando_unix SEPARATED BY space."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A03:2021-Injection",
        "owasp_2017": "A1:2017-Injection",
        "sans_top25_2023": 3,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent OS command injection:\n    - Validate and sanitize all command parameters\n    - Use allowlist validation for command arguments  \n    - Avoid dynamic command construction\n    - Use SAP standard functions when possible\n    - Implement proper authorization checks\n    "
    },
    {
      "rule_id": "abap-os-command-injection-001",
      "title": "OS Command Injection Vulnerability",
      "message": "System command execution with unvalidated user input",
      "severity": "CRITICAL",
      "cwe": "CWE-78",
      "location": {
        "file": "test-code\\YSU_DOWN_INFO.TXT",
        "line": 916,
        "line_content": "CALL 'SYSTEM' ID 'COMMAND' FIELD w_comando_unix.",
        "matched_text": "CALL 'SYSTEM' ID 'COMMAND' FIELD w_comando_unix",
        "context": [
          "           WHEN 'MOVE'.",
          "             CONCATENATE 'mv' fileorig filedest",
          "                   INTO w_comando_unix SEPARATED BY space.",
          ">>           CALL 'SYSTEM' ID 'COMMAND' FIELD w_comando_unix.",
          "         ENDCASE.",
          "   *  else.",
          "   *   message e000 with 'No tiene autorizacin para grabar.'."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A03:2021-Injection",
        "owasp_2017": "A1:2017-Injection",
        "sans_top25_2023": 3,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent OS command injection:\n    - Validate and sanitize all command parameters\n    - Use allowlist validation for command arguments  \n    - Avoid dynamic command construction\n    - Use SAP standard functions when possible\n    - Implement proper authorization checks\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YSU_DOWN_INFO.TXT",
        "line": 509,
        "line_content": "READ DATASET path_name INTO buffer.",
        "matched_text": "READ DATASET path_name",
        "context": [
          "   ",
          "     PERFORM mensaje_pantalla USING 'Cargando fichero en memoria'.",
          "     DO.",
          ">>     READ DATASET path_name INTO buffer.",
          "       IF sy-subrc <> 0.",
          "         EXIT.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YSU_DOWN_INFO.TXT",
        "line": 539,
        "line_content": "READ DATASET path_name INTO buffer.",
        "matched_text": "READ DATASET path_name",
        "context": [
          "   *< Proyecto Upgrade",
          "   ",
          "     DO.",
          ">>     READ DATASET path_name INTO buffer.",
          "       IF sy-subrc <> 0.",
          "         EXIT.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YSU_DOWN_INFO.TXT",
        "line": 1010,
        "line_content": "DELETE DATASET ls_dir_sel.",
        "matched_text": "DELETE DATASET ls_dir_sel",
        "context": [
          "       IF correcto = 'S'.",
          "   ",
          "         PERFORM mensaje_pantalla USING 'Borrando fichero'.",
          ">>       DELETE DATASET ls_dir_sel.",
          "   ",
          "       ELSE.",
          "         MESSAGE e000 WITH 'No tiene autorizacin para borrar el fichero ' ls_dir_sel."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YSU_DOWN_INFO.TXT",
        "line": 562,
        "line_content": "TRANSFER file_txt TO path_name.",
        "matched_text": "TRANSFER file_txt TO path_name",
        "context": [
          "     IF sy-subrc = 0.",
          "       PERFORM mensaje_pantalla USING 'Grabando Fichero'.",
          "       LOOP AT file_txt.",
          ">>       TRANSFER file_txt TO path_name.",
          "       ENDLOOP.",
          "     ELSE.",
          "       MESSAGE e000 WITH 'No tiene autorizacion para grabar el fichero.'."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YSU_DOWN_INFO.TXT",
        "line": 504,
        "line_content": "OPEN DATASET path_name FOR INPUT IN TEXT MODE ENCODING NON-UNICODE.",
        "matched_text": "OPEN DATASET path_name FOR INPUT",
        "context": [
          "   ",
          "   *> Proyecto Upgrade",
          "   *  OPEN DATASET PATH_NAME FOR INPUT IN TEXT MODE encoding DEFAULT.",
          ">>   OPEN DATASET path_name FOR INPUT IN TEXT MODE ENCODING NON-UNICODE.",
          "   *< Proyecto Upgrade",
          "   ",
          "     PERFORM mensaje_pantalla USING 'Cargando fichero en memoria'."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YSU_DOWN_INFO.TXT",
        "line": 535,
        "line_content": "OPEN DATASET path_name FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE.",
        "matched_text": "OPEN DATASET path_name FOR OUTPUT",
        "context": [
          "   ",
          "   *> Proyecto Upgrade",
          "   *  OPEN DATASET PATH_NAME FOR OUTPUT IN TEXT MODE ENCODING DEFAULT.",
          ">>   OPEN DATASET path_name FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE.",
          "   *< Proyecto Upgrade",
          "   ",
          "     DO."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YSU_DOWN_INFO.TXT",
        "line": 556,
        "line_content": "OPEN DATASET path_name FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE.",
        "matched_text": "OPEN DATASET path_name FOR OUTPUT",
        "context": [
          "   ",
          "   *> Proyecto Upgrade",
          "   *  OPEN DATASET PATH_NAME FOR OUTPUT IN TEXT MODE ENCODING DEFAULT.",
          ">>   OPEN DATASET path_name FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE.",
          "   *< Proyecto Upgrade",
          "   ",
          "     IF sy-subrc = 0."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YSU_DOWN_INFO.TXT",
        "line": 1036,
        "line_content": "OPEN DATASET p_dir FOR APPENDING IN TEXT MODE ENCODING NON-UNICODE.",
        "matched_text": "OPEN DATASET p_dir FOR APPENDING",
        "context": [
          "   ",
          "   *> Proyecto Upgrade",
          "   *  OPEN DATASET NEW_DIR FOR APPENDING IN TEXT MODE ENCODING DEFAULT.",
          ">>   OPEN DATASET p_dir FOR APPENDING IN TEXT MODE ENCODING NON-UNICODE.",
          "   *< Proyecto Upgrade",
          "   ",
          "     IF sy-subrc NE 0."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-os-command-injection-001",
      "title": "OS Command Injection Vulnerability",
      "message": "System command execution with unvalidated user input",
      "severity": "CRITICAL",
      "cwe": "CWE-78",
      "location": {
        "file": "test-code\\YSU0027.TXT",
        "line": 799,
        "line_content": "CALL 'SYSTEM' ID 'COMMAND' FIELD w_comando_unix.",
        "matched_text": "CALL 'SYSTEM' ID 'COMMAND' FIELD w_comando_unix",
        "context": [
          "           WHEN 'COPY'.",
          "             CONCATENATE 'cp' fileorig filedest",
          "                   INTO w_comando_unix SEPARATED BY space.",
          ">>           CALL 'SYSTEM' ID 'COMMAND' FIELD w_comando_unix.",
          "           WHEN 'MOVE'.",
          "             CONCATENATE 'mv' fileorig filedest",
          "                   INTO w_comando_unix SEPARATED BY space."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A03:2021-Injection",
        "owasp_2017": "A1:2017-Injection",
        "sans_top25_2023": 3,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent OS command injection:\n    - Validate and sanitize all command parameters\n    - Use allowlist validation for command arguments  \n    - Avoid dynamic command construction\n    - Use SAP standard functions when possible\n    - Implement proper authorization checks\n    "
    },
    {
      "rule_id": "abap-os-command-injection-001",
      "title": "OS Command Injection Vulnerability",
      "message": "System command execution with unvalidated user input",
      "severity": "CRITICAL",
      "cwe": "CWE-78",
      "location": {
        "file": "test-code\\YSU0027.TXT",
        "line": 803,
        "line_content": "CALL 'SYSTEM' ID 'COMMAND' FIELD w_comando_unix.",
        "matched_text": "CALL 'SYSTEM' ID 'COMMAND' FIELD w_comando_unix",
        "context": [
          "           WHEN 'MOVE'.",
          "             CONCATENATE 'mv' fileorig filedest",
          "                   INTO w_comando_unix SEPARATED BY space.",
          ">>           CALL 'SYSTEM' ID 'COMMAND' FIELD w_comando_unix.",
          "         ENDCASE.",
          "   *  else.",
          "   *   message e000 with 'No tiene autorizacin para grabar.'."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A03:2021-Injection",
        "owasp_2017": "A1:2017-Injection",
        "sans_top25_2023": 3,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent OS command injection:\n    - Validate and sanitize all command parameters\n    - Use allowlist validation for command arguments  \n    - Avoid dynamic command construction\n    - Use SAP standard functions when possible\n    - Implement proper authorization checks\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YSU0027.TXT",
        "line": 397,
        "line_content": "READ DATASET path_name INTO buffer.",
        "matched_text": "READ DATASET path_name",
        "context": [
          "   ",
          "     PERFORM mensaje_pantalla USING 'Cargando fichero en memoria'.",
          "     DO.",
          ">>     READ DATASET path_name INTO buffer.",
          "       IF sy-subrc <> 0.",
          "         EXIT.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YSU0027.TXT",
        "line": 427,
        "line_content": "READ DATASET path_name INTO buffer.",
        "matched_text": "READ DATASET path_name",
        "context": [
          "   *< Proyecto Upgrade",
          "   ",
          "     DO.",
          ">>     READ DATASET path_name INTO buffer.",
          "       IF sy-subrc <> 0.",
          "         EXIT.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YSU0027.TXT",
        "line": 893,
        "line_content": "DELETE DATASET new_dir.",
        "matched_text": "DELETE DATASET new_dir",
        "context": [
          "         CHECK retorno = 'OKY'.",
          "       ENDIF.",
          "       PERFORM mensaje_pantalla USING 'Borrando fichero'.",
          ">>     DELETE DATASET new_dir.",
          "   *   call function 'EPS_DELETE_FILE'",
          "   *        exporting",
          "   *             file_name              = fitxer"
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YSU0027.TXT",
        "line": 450,
        "line_content": "TRANSFER file_txt TO path_name.",
        "matched_text": "TRANSFER file_txt TO path_name",
        "context": [
          "     IF sy-subrc = 0.",
          "       PERFORM mensaje_pantalla USING 'Grabando Fichero'.",
          "       LOOP AT file_txt.",
          ">>       TRANSFER file_txt TO path_name.",
          "       ENDLOOP.",
          "     ELSE.",
          "       MESSAGE e000 WITH 'No tiene autorizacion para grabar el fichero.'."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YSU0027.TXT",
        "line": 392,
        "line_content": "OPEN DATASET path_name FOR INPUT IN TEXT MODE ENCODING NON-UNICODE.",
        "matched_text": "OPEN DATASET path_name FOR INPUT",
        "context": [
          "   ",
          "   *> Proyecto Upgrade",
          "   *  OPEN DATASET PATH_NAME FOR INPUT IN TEXT MODE encoding DEFAULT.",
          ">>   OPEN DATASET path_name FOR INPUT IN TEXT MODE ENCODING NON-UNICODE.",
          "   *< Proyecto Upgrade",
          "   ",
          "     PERFORM mensaje_pantalla USING 'Cargando fichero en memoria'."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YSU0027.TXT",
        "line": 423,
        "line_content": "OPEN DATASET path_name FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE.",
        "matched_text": "OPEN DATASET path_name FOR OUTPUT",
        "context": [
          "   ",
          "   *> Proyecto Upgrade",
          "   *  OPEN DATASET PATH_NAME FOR OUTPUT IN TEXT MODE ENCODING DEFAULT.",
          ">>   OPEN DATASET path_name FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE.",
          "   *< Proyecto Upgrade",
          "   ",
          "     DO."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YSU0027.TXT",
        "line": 444,
        "line_content": "OPEN DATASET path_name FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE.",
        "matched_text": "OPEN DATASET path_name FOR OUTPUT",
        "context": [
          "   ",
          "   *> Proyecto Upgrade",
          "   *  OPEN DATASET PATH_NAME FOR OUTPUT IN TEXT MODE ENCODING DEFAULT.",
          ">>   OPEN DATASET path_name FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE.",
          "   *< Proyecto Upgrade",
          "   ",
          "     IF sy-subrc = 0."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YSU0027.TXT",
        "line": 925,
        "line_content": "OPEN DATASET new_dir FOR APPENDING IN TEXT MODE ENCODING NON-UNICODE.",
        "matched_text": "OPEN DATASET new_dir FOR APPENDING",
        "context": [
          "   ",
          "   *> Proyecto Upgrade",
          "   *  OPEN DATASET NEW_DIR FOR APPENDING IN TEXT MODE ENCODING DEFAULT.",
          ">>   OPEN DATASET new_dir FOR APPENDING IN TEXT MODE ENCODING NON-UNICODE.",
          "   *< Proyecto Upgrade",
          "   ",
          "     IF sy-subrc NE 0."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\Y_FEMEXI_SD_RETORNO.TXT",
        "line": 336,
        "line_content": "READ DATASET p_path INTO hformat .",
        "matched_text": "READ DATASET p_path",
        "context": [
          "       EXIT.",
          "     ELSE.",
          "   *=============================HEADER===================================",
          ">>     READ DATASET p_path INTO hformat .",
          "       IF hformat IS INITIAL.",
          "         WRITE : 'FICHERO ESTA VACIO' .",
          "         EXIT."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\Y_FEMEXI_SD_RETORNO.TXT",
        "line": 346,
        "line_content": "READ DATASET p_path INTO aformat MAXIMUM LENGTH 434.",
        "matched_text": "READ DATASET p_path",
        "context": [
          "           DO.",
          "   *-> Inicio 1005237 18.01.2018 INXX2298",
          "   *          READ DATASET p_path INTO aformat MAXIMUM LENGTH 238.",
          ">>           READ DATASET p_path INTO aformat MAXIMUM LENGTH 434.",
          "   *<- Fin 1005237 18.01.2018 INXX2298",
          "             IF sy-subrc <> 0.",
          "               EXIT."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\Y_FEMEXI_SD_RETORNO.TXT",
        "line": 301,
        "line_content": "OPEN DATASET p_path FOR INPUT IN TEXT MODE ENCODING DEFAULT",
        "matched_text": "OPEN DATASET p_path FOR INPUT",
        "context": [
          "   *-> Inicio 1005237 23.01.2018 INXX2298",
          "   *    OPEN DATASET p_path FOR INPUT IN TEXT MODE ENCODING",
          "   *                                            DEFAULT MESSAGE d_msg_text.",
          ">>     OPEN DATASET p_path FOR INPUT IN TEXT MODE ENCODING DEFAULT",
          "                           IGNORING CONVERSION ERRORS",
          "                           MESSAGE d_msg_text.",
          "   *<- Fin 81005237 23.01.2018 INXX2298"
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\Y_FEMEXI_SD_ENVIO_F02.TXT",
        "line": 4045,
        "line_content": "DELETE DATASET lv_path.",
        "matched_text": "DELETE DATASET lv_path",
        "context": [
          "   ",
          "       CLOSE DATASET lv_path.",
          "   ",
          ">>     DELETE DATASET lv_path.",
          "   ",
          "     ENDIF.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\Y_FEMEXI_SD_ENVIO_F02.TXT",
        "line": 283,
        "line_content": "TRANSFER  <zfact_build>-filebuild TO p_path.",
        "matched_text": "TRANSFER  <zfact_build>-filebuild TO p_path",
        "context": [
          "   ",
          "   * -> Inicio 831321 11.07.2017 INXX2300",
          "   *                TRANSFER  <zfact_build> TO p_path  .",
          ">>                 TRANSFER  <zfact_build>-filebuild TO p_path.",
          "   * <- Fin 831321 11.07.2017 INXX2300",
          "   ",
          "                 CATCH cx_sy_conversion_codepage INTO lv_myref."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\Y_FEMEXI_SD_ENVIO_F02.TXT",
        "line": 306,
        "line_content": "TRANSFER  <zfact_build>-filebuild TO p_path.",
        "matched_text": "TRANSFER  <zfact_build>-filebuild TO p_path",
        "context": [
          "   *                  TRANSFER  <zfact_build> TO p_path  .",
          "   ",
          "                     TRY .",
          ">>                       TRANSFER  <zfact_build>-filebuild TO p_path.",
          "                       CATCH cx_sy_conversion_codepage INTO lv_myref.",
          "   ***                      ls_error_docs-document_number = <zfact_build>-document_number.",
          "   ***                      ls_error_docs-sociedad        = <zfact_build>-sociedad."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\Y_FEMEXI_SD_ENVIO_F02.TXT",
        "line": 4012,
        "line_content": "TRANSFER  wa_concept-concepto TO lv_path.",
        "matched_text": "TRANSFER  wa_concept-concepto TO lv_path",
        "context": [
          "   ",
          "         TRY.",
          "   ",
          ">>           TRANSFER  wa_concept-concepto TO lv_path.",
          "   ",
          "           CATCH cx_sy_conversion_codepage INTO lv_myref.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\Y_FEMEXI_SD_ENVIO_F02.TXT",
        "line": 4029,
        "line_content": "TRANSFER  wa_concept-concepto TO lv_path.",
        "matched_text": "TRANSFER  wa_concept-concepto TO lv_path",
        "context": [
          "   ",
          "   ",
          "               TRY .",
          ">>                 TRANSFER  wa_concept-concepto TO lv_path.",
          "   ",
          "                 CATCH cx_sy_conversion_codepage INTO lv_myref.",
          "                   ls_error_docs-document_number = wa_concept-zvbeln."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\Y_FEMEXI_SD_ENVIO_F02.TXT",
        "line": 185,
        "line_content": "OPEN DATASET p_path FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE",
        "matched_text": "OPEN DATASET p_path FOR OUTPUT",
        "context": [
          "   ",
          "     PERFORM check_name_file  USING p_path CHANGING f_direc.",
          "     IF f_direc NE space.",
          ">>     OPEN DATASET p_path FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE",
          "   MESSAGE d_msg_text .",
          "   ",
          "       IF sy-subrc NE 0 ."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\Y_FEMEXI_SD_ENVIO_F02.TXT",
        "line": 4002,
        "line_content": "OPEN DATASET lv_path FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE.",
        "matched_text": "OPEN DATASET lv_path FOR OUTPUT",
        "context": [
          "     CONCATENATE lv_path 'temporal' '_' sy-datum '_' sy-uzeit '.txt' INTO lv_path.",
          "   ",
          "   ",
          ">>   OPEN DATASET lv_path FOR OUTPUT IN TEXT MODE ENCODING NON-UNICODE.",
          "   ",
          "     IF sy-subrc = 0.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-broken-auth-001",
      "title": "Insufficient Authorization Check Vulnerability",
      "message": "AUTHORITY-CHECK statement without proper sy-subrc validation",
      "severity": "HIGH",
      "cwe": "CWE-285",
      "location": {
        "file": "test-code\\ZCFM_RFID_BR_TR_CUST_LPCP_P01.TXT",
        "line": 36,
        "line_content": "AUTHORITY-CHECK OBJECT 'F_BKPF_BUK'",
        "matched_text": "AUTHORITY-CHECK OBJECT 'F_BKPF_BUK'\n    ID 'BUKRS' FIELD s_compy\n    ID 'ACTVT' FIELD '01'.",
        "context": [
          "     lv_proc_date = sy-datum.",
          "     lv_proc_time = sy-uzeit.",
          "   * Authority check",
          ">>   AUTHORITY-CHECK OBJECT 'F_BKPF_BUK'",
          "       ID 'BUKRS' FIELD s_compy",
          "       ID 'ACTVT' FIELD '01'.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": null,
        "confidence": "HIGH"
      },
      "remediation": "\n    Always check sy-subrc after AUTHORITY-CHECK:\n    AUTHORITY-CHECK OBJECT 'S_TCODE' ID 'TCD' FIELD sy-tcode.\n    IF sy-subrc <> 0.\n      MESSAGE 'No authorization' TYPE 'E'.\n      RETURN.\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-os-command-injection-001",
      "title": "OS Command Injection Vulnerability",
      "message": "System command execution with unvalidated user input",
      "severity": "CRITICAL",
      "cwe": "CWE-78",
      "location": {
        "file": "test-code\\ZDMINV_PI_PRC.TXT",
        "line": 4328,
        "line_content": "CALL METHOD cl_gui_frontend_services=>execute",
        "matched_text": "cl_gui_frontend_services=>execute",
        "context": [
          "   *    WRITE l_str.",
          "       ENDIF.",
          "   ****FE",
          ">>     CALL METHOD cl_gui_frontend_services=>execute",
          "         EXPORTING",
          "           document               = l_str",
          "   *       OPERATION              = 'OPEN'"
        ]
      },
      "security_metadata": {
        "owasp_2021": "A03:2021-Injection",
        "owasp_2017": "A1:2017-Injection",
        "sans_top25_2023": 3,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent OS command injection:\n    - Validate and sanitize all command parameters\n    - Use allowlist validation for command arguments  \n    - Avoid dynamic command construction\n    - Use SAP standard functions when possible\n    - Implement proper authorization checks\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZFILECONTENTCONVERSION.TXT",
        "line": 382,
        "line_content": "READ DATASET iv_fname INTO lv_line.",
        "matched_text": "READ DATASET iv_fname",
        "context": [
          "         ENDIF.",
          "         IF sy-subrc = 0.",
          "           DO.",
          ">>           READ DATASET iv_fname INTO lv_line.",
          "             IF sy-subrc <> 0.",
          "               EXIT.",
          "             ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZFILECONTENTCONVERSION.TXT",
        "line": 439,
        "line_content": "READ DATASET iv_fname INTO lv_line.",
        "matched_text": "READ DATASET iv_fname",
        "context": [
          "         ENDIF.",
          "         IF sy-subrc = 0.",
          "           DO.",
          ">>           READ DATASET iv_fname INTO lv_line.",
          "             IF sy-subrc <> 0.",
          "               EXIT.",
          "             ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZFILECONTENTCONVERSION.TXT",
        "line": 522,
        "line_content": "DELETE DATASET iv_dele.",
        "matched_text": "DELETE DATASET iv_dele",
        "context": [
          "         ENDIF.",
          "         CLOSE DATASET iv_fname.",
          "         IF NOT iv_dele IS INITIAL.",
          ">>         DELETE DATASET iv_dele.",
          "         ENDIF.",
          "       CATCH cx_root INTO DATA(lr_exception2).",
          "         CALL METHOD lr_exception2->if_message~get_text"
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZFILECONTENTCONVERSION.TXT",
        "line": 514,
        "line_content": "TRANSFER lv_line TO iv_fname.",
        "matched_text": "TRANSFER lv_line TO iv_fname",
        "context": [
          "         OPEN DATASET iv_fname FOR OUTPUT IN TEXT MODE ENCODING DEFAULT.",
          "         IF sy-subrc = 0.",
          "           LOOP AT it_line INTO DATA(lv_line).",
          ">>           TRANSFER lv_line TO iv_fname.",
          "           ENDLOOP.",
          "         ELSE.",
          "           gv_error = |Unable to Open DataSet for { iv_fname } for output.|."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZFILECONTENTCONVERSION.TXT",
        "line": 371,
        "line_content": "OPEN DATASET iv_fname FOR INPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET iv_fname FOR INPUT",
        "context": [
          "   ",
          "     TRY.",
          "         IF lv_enc EQ 'U'. \"UTF-8",
          ">>         OPEN DATASET iv_fname FOR INPUT IN TEXT MODE ENCODING UTF-8.",
          "         ELSEIF lv_enc EQ 'O'. \"Other",
          "           OPEN DATASET iv_fname FOR INPUT IN LEGACY TEXT MODE CODE PAGE '1100'.",
          "         ELSEIF lv_enc EQ 'A'. \"Other"
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZFILECONTENTCONVERSION.TXT",
        "line": 373,
        "line_content": "OPEN DATASET iv_fname FOR INPUT IN LEGACY TEXT MODE CODE PAGE '1100'.",
        "matched_text": "OPEN DATASET iv_fname FOR INPUT",
        "context": [
          "         IF lv_enc EQ 'U'. \"UTF-8",
          "           OPEN DATASET iv_fname FOR INPUT IN TEXT MODE ENCODING UTF-8.",
          "         ELSEIF lv_enc EQ 'O'. \"Other",
          ">>         OPEN DATASET iv_fname FOR INPUT IN LEGACY TEXT MODE CODE PAGE '1100'.",
          "         ELSEIF lv_enc EQ 'A'. \"Other",
          "           OPEN DATASET iv_fname FOR INPUT IN LEGACY TEXT MODE CODE PAGE '1100'.",
          "         ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZFILECONTENTCONVERSION.TXT",
        "line": 375,
        "line_content": "OPEN DATASET iv_fname FOR INPUT IN LEGACY TEXT MODE CODE PAGE '1100'.",
        "matched_text": "OPEN DATASET iv_fname FOR INPUT",
        "context": [
          "         ELSEIF lv_enc EQ 'O'. \"Other",
          "           OPEN DATASET iv_fname FOR INPUT IN LEGACY TEXT MODE CODE PAGE '1100'.",
          "         ELSEIF lv_enc EQ 'A'. \"Other",
          ">>         OPEN DATASET iv_fname FOR INPUT IN LEGACY TEXT MODE CODE PAGE '1100'.",
          "         ELSE.",
          "           gv_error = 'No puede leer el fichero'.",
          "           MESSAGE gv_error TYPE 'I' DISPLAY LIKE 'E'."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZFILECONTENTCONVERSION.TXT",
        "line": 428,
        "line_content": "OPEN DATASET iv_fname FOR INPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET iv_fname FOR INPUT",
        "context": [
          "   ",
          "     TRY.",
          "         IF lv_enc EQ 'U'. \"UTF-8",
          ">>         OPEN DATASET iv_fname FOR INPUT IN TEXT MODE ENCODING UTF-8.",
          "         ELSEIF lv_enc EQ 'O'. \"Other",
          "           OPEN DATASET iv_fname FOR INPUT IN LEGACY TEXT MODE CODE PAGE '1100'.",
          "         ELSEIF lv_enc EQ 'A'. \"Other"
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZFILECONTENTCONVERSION.TXT",
        "line": 430,
        "line_content": "OPEN DATASET iv_fname FOR INPUT IN LEGACY TEXT MODE CODE PAGE '1100'.",
        "matched_text": "OPEN DATASET iv_fname FOR INPUT",
        "context": [
          "         IF lv_enc EQ 'U'. \"UTF-8",
          "           OPEN DATASET iv_fname FOR INPUT IN TEXT MODE ENCODING UTF-8.",
          "         ELSEIF lv_enc EQ 'O'. \"Other",
          ">>         OPEN DATASET iv_fname FOR INPUT IN LEGACY TEXT MODE CODE PAGE '1100'.",
          "         ELSEIF lv_enc EQ 'A'. \"Other",
          "           OPEN DATASET iv_fname FOR INPUT IN LEGACY TEXT MODE CODE PAGE '1100'.",
          "         ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZFILECONTENTCONVERSION.TXT",
        "line": 432,
        "line_content": "OPEN DATASET iv_fname FOR INPUT IN LEGACY TEXT MODE CODE PAGE '1100'.",
        "matched_text": "OPEN DATASET iv_fname FOR INPUT",
        "context": [
          "         ELSEIF lv_enc EQ 'O'. \"Other",
          "           OPEN DATASET iv_fname FOR INPUT IN LEGACY TEXT MODE CODE PAGE '1100'.",
          "         ELSEIF lv_enc EQ 'A'. \"Other",
          ">>         OPEN DATASET iv_fname FOR INPUT IN LEGACY TEXT MODE CODE PAGE '1100'.",
          "         ELSE.",
          "           gv_error = 'No puede leer el fichero'.",
          "           MESSAGE gv_error TYPE 'I' DISPLAY LIKE 'E'."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZFILECONTENTCONVERSION.TXT",
        "line": 511,
        "line_content": "OPEN DATASET iv_fname FOR OUTPUT IN TEXT MODE ENCODING DEFAULT.",
        "matched_text": "OPEN DATASET iv_fname FOR OUTPUT",
        "context": [
          "           it_line  TYPE tt_lines.",
          "   ",
          "     TRY.",
          ">>       OPEN DATASET iv_fname FOR OUTPUT IN TEXT MODE ENCODING DEFAULT.",
          "         IF sy-subrc = 0.",
          "           LOOP AT it_line INTO DATA(lv_line).",
          "             TRANSFER lv_line TO iv_fname."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZFININ_FICHEROPAGO.TXT",
        "line": 1118,
        "line_content": "TRANSFER lv_linefile TO lv_filename.",
        "matched_text": "TRANSFER lv_linefile TO lv_filename",
        "context": [
          "   ",
          "       ENDDO.",
          "   ",
          ">>     TRANSFER lv_linefile TO lv_filename.",
          "   ",
          "       IF sy-subrc <> 0.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZFININ_FICHEROPAGO.TXT",
        "line": 1195,
        "line_content": "TRANSFER lv_linefile TO lv_filename.",
        "matched_text": "TRANSFER lv_linefile TO lv_filename",
        "context": [
          "   ",
          "       ENDDO.",
          "   ",
          ">>     TRANSFER lv_linefile TO lv_filename.",
          "   ",
          "       IF sy-subrc <> 0.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZFININ_FICHEROPAGO.TXT",
        "line": 1091,
        "line_content": "OPEN DATASET lv_filename FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET lv_filename FOR OUTPUT",
        "context": [
          "   ",
          "     ENDIF.",
          "   ",
          ">>   OPEN DATASET lv_filename FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "   ",
          "     LOOP AT gt_file INTO DATA(ls_file).",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZFININ_FICHEROPAGO.TXT",
        "line": 1168,
        "line_content": "OPEN DATASET lv_filename FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "OPEN DATASET lv_filename FOR OUTPUT",
        "context": [
          "   ",
          "     ENDIF.",
          "   ",
          ">>   OPEN DATASET lv_filename FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "   ",
          "     LOOP AT gt_file_extended INTO DATA(ls_file).",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZFINF_CFM_CARGA_AVAL.TXT",
        "line": 1878,
        "line_content": "READ DATASET fich_loc INTO tab_fich.",
        "matched_text": "READ DATASET fich_loc",
        "context": [
          "       MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno",
          "              WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.",
          "     ENDIF.",
          ">>   READ DATASET fich_loc INTO tab_fich.",
          "     WHILE sy-subrc = 0.",
          "       it_aval-rfha = tab_fich-rfha.",
          "       IF it_aval-rfha IS NOT INITIAL."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZFINF_CFM_CARGA_AVAL.TXT",
        "line": 1988,
        "line_content": "READ DATASET fich_loc INTO tab_fich.",
        "matched_text": "READ DATASET fich_loc",
        "context": [
          "       it_aval-reg = vl_contadorn.",
          "       APPEND it_aval.",
          "       CLEAR it_aval.",
          ">>     READ DATASET fich_loc INTO tab_fich.",
          "     ENDWHILE.",
          "     CLOSE DATASET fich_loc.",
          "     IF sy-subrc <> 0."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZFINF_CFM_CARGA_AVAL.TXT",
        "line": 7802,
        "line_content": "TRANSFER it_fich_err TO p_erro.",
        "matched_text": "TRANSFER it_fich_err TO p_erro",
        "context": [
          "                            p_erro.",
          "       ENDIF.",
          "       LOOP AT it_fich_err.",
          ">>       TRANSFER it_fich_err TO p_erro.",
          "       ENDLOOP.",
          "   ",
          "       CLOSE DATASET p_erro."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZFINF_CFM_CARGA_AVAL.TXT",
        "line": 1872,
        "line_content": "OPEN DATASET fich_loc FOR INPUT",
        "matched_text": "OPEN DATASET fich_loc FOR INPUT",
        "context": [
          "     CLEAR it_aval.",
          "     REFRESH it_aval.",
          "     CLEAR vl_contador.",
          ">>   OPEN DATASET fich_loc FOR INPUT",
          "                           IN TEXT MODE ENCODING NON-UNICODE.",
          "     IF sy-subrc <> 0.",
          "       MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno"
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZFINF_CFM_CARGA_AVAL.TXT",
        "line": 7795,
        "line_content": "OPEN DATASET p_erro FOR OUTPUT IN TEXT MODE",
        "matched_text": "OPEN DATASET p_erro FOR OUTPUT",
        "context": [
          "   ",
          "     ELSE.",
          "   ",
          ">>     OPEN DATASET p_erro FOR OUTPUT IN TEXT MODE",
          "                  ENCODING NON-UNICODE.",
          "       IF sy-subrc <> 0.",
          "         MESSAGE e368(00) WITH 'No se ha podido abrir el fichero'"
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-broken-auth-001",
      "title": "Insufficient Authorization Check Vulnerability",
      "message": "AUTHORITY-CHECK statement without proper sy-subrc validation",
      "severity": "HIGH",
      "cwe": "CWE-285",
      "location": {
        "file": "test-code\\ZFINRCYRFTBBB00.TXT",
        "line": 542,
        "line_content": "AUTHORITY-CHECK OBJECT 'F_T_TRANSB'",
        "matched_text": "AUTHORITY-CHECK OBJECT 'F_T_TRANSB'\n                  ID     'TCD'\n                  FIELD  transaktion.",
        "context": [
          "     SET UPDATE TASK LOCAL.",
          "   ",
          "   * Berechtigungsprfung:",
          ">>   AUTHORITY-CHECK OBJECT 'F_T_TRANSB'",
          "                     ID     'TCD'",
          "                     FIELD  transaktion.",
          "     IF NOT sy-subrc IS INITIAL."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": null,
        "confidence": "HIGH"
      },
      "remediation": "\n    Always check sy-subrc after AUTHORITY-CHECK:\n    AUTHORITY-CHECK OBJECT 'S_TCODE' ID 'TCD' FIELD sy-tcode.\n    IF sy-subrc <> 0.\n      MESSAGE 'No authorization' TYPE 'E'.\n      RETURN.\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-dummy-auth-001",
      "title": "Ineffective Authorization Checks Detected",
      "message": "AUTHORITY-CHECK using DUMMY parameters bypasses security",
      "severity": "CRITICAL",
      "cwe": "CWE-285",
      "location": {
        "file": "test-code\\ZFINRCYRFTBBB00.TXT",
        "line": 542,
        "line_content": "AUTHORITY-CHECK OBJECT 'F_T_TRANSB'",
        "matched_text": "AUTHORITY-CHECK OBJECT 'F_T_TRANSB'\n                  ID     'TCD'\n                  FIELD  transaktion.\n  IF NOT sy-subrc IS INITIAL.\n    MESSAGE ...",
        "context": [
          "     SET UPDATE TASK LOCAL.",
          "   ",
          "   * Berechtigungsprfung:",
          ">>   AUTHORITY-CHECK OBJECT 'F_T_TRANSB'",
          "                     ID     'TCD'",
          "                     FIELD  transaktion.",
          "     IF NOT sy-subrc IS INITIAL."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": null,
        "sans_top25_2023": null,
        "confidence": "HIGH"
      },
      "remediation": "\n    Replace DUMMY parameters with actual field values:\n    AUTHORITY-CHECK OBJECT 'S_TCODE' \n      ID 'TCD' FIELD sy-tcode.   Use actual field, not DUMMY\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZGI_MIGRACION_ESTADOS.TXT",
        "line": 342,
        "line_content": "READ DATASET lv_file INTO ls_tab.",
        "matched_text": "READ DATASET lv_file",
        "context": [
          "               APPEND ls_tab TO lt_tab.",
          "             ENDIF.",
          "             CLEAR ls_tab.",
          ">>           READ DATASET lv_file INTO ls_tab.",
          "           ENDDO.",
          "           CLOSE DATASET lv_file.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\ZGI_MIGRACION_ESTADOS.TXT",
        "line": 333,
        "line_content": "OPEN DATASET lv_file FOR INPUT IN TEXT MODE ENCODING DEFAULT.",
        "matched_text": "OPEN DATASET lv_file FOR INPUT",
        "context": [
          "           WRITE 'El formato del archivo no es CSV.' COLOR COL_NEGATIVE.",
          "         ELSE.",
          "           sy-subrc = 0.",
          ">>         OPEN DATASET lv_file FOR INPUT IN TEXT MODE ENCODING DEFAULT.",
          "           DO.",
          "             IF sy-subrc <> 0.",
          "               EXIT."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-broken-auth-001",
      "title": "Insufficient Authorization Check Vulnerability",
      "message": "AUTHORITY-CHECK statement without proper sy-subrc validation",
      "severity": "HIGH",
      "cwe": "CWE-285",
      "location": {
        "file": "test-code\\ZGRAC_SEGUIMIENTO_AUD_F02.TXT",
        "line": 491,
        "line_content": "AUTHORITY-CHECK OBJECT 'S_PROGRAM'",
        "matched_text": "AUTHORITY-CHECK OBJECT 'S_PROGRAM'\n            ID 'P_ACTION' FIELD 'SUBMIT'\n            ID 'P_GROUP'  FIELD 'EXEC'.",
        "context": [
          "   ",
          "   * Chequeo de autorizacion",
          "   ** Agregar en los atributos del programa.",
          ">>   AUTHORITY-CHECK OBJECT 'S_PROGRAM'",
          "               ID 'P_ACTION' FIELD 'SUBMIT'",
          "               ID 'P_GROUP'  FIELD 'EXEC'.",
          "   "
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": null,
        "confidence": "HIGH"
      },
      "remediation": "\n    Always check sy-subrc after AUTHORITY-CHECK:\n    AUTHORITY-CHECK OBJECT 'S_TCODE' ID 'TCD' FIELD sy-tcode.\n    IF sy-subrc <> 0.\n      MESSAGE 'No authorization' TYPE 'E'.\n      RETURN.\n    ENDIF.\n    "
    }
  ]
}