{
  "scan_metadata": {
    "scanner": {
      "name": "ABAP Security Scanner",
      "version": "1.5.0"
    },
    "scan": {
      "timestamp": "2025-11-11T21:43:08.389216+00:00",
      "target_path": "test-sample",
      "duration_seconds": 6.06,
      "files_scanned": 4,
      "findings_total": 2
    }
  },
  "statistics": {
    "files": {
      "total_scanned": 411,
      "with_issues": 42
    },
    "findings": {
      "total": 2,
      "by_severity": {
        "HIGH": 2,
        "CRITICAL": 0
      },
      "by_cwe": {
        "CWE-22": 213,
        "CWE-94": 4,
        "CWE-78": 10,
        "CWE-91": 3,
        "CWE-285": 4
      }
    }
  },
  "findings": [
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YAL0029.TXT",
        "line": 679,
        "line_content": "OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
        "matched_text": "File operation using unvalidated path variable 'ld_path'",
        "context": [
          "   ",
          "     ELSEIF rb_ser EQ abap_true.",
          "       CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY '/'.",
          ">>     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.",
          "       IF sy-subrc EQ 0.",
          "         lf_fich_open = abap_true.",
          "       ELSE."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    },
    {
      "rule_id": "abap-directory-traversal-001",
      "title": "Directory Traversal Vulnerability",
      "message": "File operation with unvalidated path may allow directory traversal",
      "severity": "HIGH",
      "cwe": "CWE-22",
      "location": {
        "file": "test-code\\YAL0029.TXT",
        "line": 780,
        "line_content": "DELETE DATASET ld_path.",
        "matched_text": "DELETE DATASET ld_path",
        "context": [
          "   ",
          "         IF sy-subrc EQ 0.",
          "   *       Si la compresion ha ido bien, se borra el fichero original",
          ">>         DELETE DATASET ld_path.",
          "         ENDIF.",
          "       ENDIF.",
          "     ENDIF."
        ]
      },
      "security_metadata": {
        "owasp_2021": "A01:2021-Broken Access Control",
        "owasp_2017": "A5:2017-Broken Access Control",
        "sans_top25_2023": 4,
        "confidence": "HIGH"
      },
      "remediation": "\n    Prevent directory traversal:\n    - Validate file paths using FILE_VALIDATE_NAME\n    - Use absolute paths with proper validation\n    - Implement allowlist for accessible directories\n    - Check sy-subrc after FILE_VALIDATE_NAME call\n    \n    Example:\n    CALL FUNCTION 'FILE_VALIDATE_NAME'\n      EXPORTING logical_filename = file_path\n      EXCEPTIONS OTHERS = 1.\n    IF sy-subrc = 0.\n      \" Safe to use file_path\n    ENDIF.\n    "
    }
   
  ]
}