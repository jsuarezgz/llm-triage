 <!-- adapters/output/templates/report.html -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üõ°Ô∏è Security Analysis Platform v3.0 - Report</title>
<!-- adapters/output/templates/styles.html -->
<style>
/* === RESET & BASE === */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    line-height: 1.6;
    color: #1f2937;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
}

/* === LAYOUT === */
.container {
    max-width: 1200px;
    margin: 20px auto;
    background: white;
    border-radius: 16px;
    box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
    overflow: hidden;
}

/* === HEADER === */
.header {
    background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 50%, #db2777 100%);
    color: white;
    padding: 2rem;
    position: relative;
}

.header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url('image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
    opacity: 0.3;
}

.header-content {
    position: relative;
    z-index: 1;
    text-align: center;
}

.header h1 {
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 1rem;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
}

.header-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin-top: 1.5rem;
}

.header-item {
    background: rgba(255, 255, 255, 0.15);
    padding: 1rem;
    border-radius: 12px;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.header-label {
    font-size: 0.875rem;
    opacity: 0.9;
    margin-bottom: 0.25rem;
}

.header-value {
    font-size: 1.25rem;
    font-weight: 600;
}

/* === CONTENT === */
.content {
    padding: 2rem;
}

.section {
    margin-bottom: 3rem;
}

.section-title {
    font-size: 1.875rem;
    font-weight: 700;
    color: #1f2937;
    margin-bottom: 1.5rem;
    padding-bottom: 0.75rem;
    border-bottom: 3px solid #4f46e5;
    position: relative;
}

.section-title::after {
    content: '';
    position: absolute;
    bottom: -3px;
    left: 0;
    width: 60px;
    height: 3px;
    background: linear-gradient(90deg, #4f46e5, #7c3aed);
}

/* === METRICS === */
.metrics-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.metric-card {
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
    border-radius: 16px;
    padding: 1.5rem;
    text-align: center;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    position: relative;
    overflow: hidden;
}

.metric-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #4f46e5, #7c3aed);
}

.metric-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 20px 25px rgba(0, 0, 0, 0.1);
}

.metric-icon {
    font-size: 2rem;
    margin-bottom: 0.5rem;
}

.metric-value {
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    background: linear-gradient(135deg, #4f46e5, #7c3aed);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.metric-label {
    color: #64748b;
    font-size: 0.875rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

/* === VULNERABILITIES === */
.vulnerabilities-list {
    display: grid;
    gap: 1.5rem;
}

.vulnerability-card {
    background: white;
    border: 1px solid #e5e7eb;
    border-radius: 16px;
    overflow: hidden;
    transition: all 0.3s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.vulnerability-card:hover {
    box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15);
    transform: translateY(-2px);
}

.vulnerability-card.critical {
    border-left: 6px solid #dc2626;
}

.vulnerability-card.high {
    border-left: 6px solid #ea580c;
}

.vulnerability-card.medium {
    border-left: 6px solid #d97706;
}

.vulnerability-card.low {
    border-left: 6px solid #16a34a;
}

.vulnerability-card.info {
    border-left: 6px solid #0ea5e9;
}

.vuln-header {
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
    padding: 1.5rem;
    border-bottom: 1px solid #e5e7eb;
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 1rem;
}

.vuln-title {
    font-size: 1.25rem;
    font-weight: 600;
    color: #1f2937;
    flex: 1;
}

.vuln-badges {
    display: flex;
    gap: 0.5rem;
    flex-shrink: 0;
}

.badge {
    padding: 0.25rem 0.75rem;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.badge.severity-critical {
    background: #dc2626;
    color: white;
}

.badge.severity-high {
    background: #ea580c;
    color: white;
}

.badge.severity-medium {
    background: #d97706;
    color: white;
}

.badge.severity-low {
    background: #16a34a;
    color: white;
}

.badge.severity-info {
    background: #0ea5e9;
    color: white;
}

.badge.type-badge {
    background: #6b7280;
    color: white;
}

.vuln-body {
    padding: 1.5rem;
}

.vuln-meta {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.meta-item {
    background: #f8fafc;
    padding: 0.75rem;
    border-radius: 8px;
    border: 1px solid #e5e7eb;
}

.meta-label {
    font-size: 0.75rem;
    font-weight: 600;
    color: #6b7280;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 0.25rem;
}

.meta-value {
    font-weight: 500;
    color: #1f2937;
}

.meta-value a {
    color: #4f46e5;
    text-decoration: none;
}

.meta-value a:hover {
    text-decoration: underline;
}

.vuln-description,
.vuln-code,
.vuln-remediation {
    margin-bottom: 1.5rem;
}

.vuln-description h4,
.vuln-code h4,
.vuln-remediation h4 {
    font-size: 1rem;
    font-weight: 600;
    color: #374151;
    margin-bottom: 0.75rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.code-block {
    background: #0f172a;
    color: #e2e8f0;
    padding: 1rem;
    border-radius: 8px;
    font-family: 'JetBrains Mono', 'Fira Code', Monaco, monospace;
    font-size: 0.875rem;
    overflow-x: auto;
    line-height: 1.5;
    border: 1px solid #334155;
}

.advice-content {
    background: #dbeafe;
    padding: 1rem;
    border-radius: 8px;
    border-left: 4px solid #3b82f6;
    color: #1e40af;
}

/* === NO VULNERABILITIES === */
.no-vulnerabilities {
    text-align: center;
    padding: 4rem 2rem;
    background: linear-gradient(135deg, #22c55e, #16a34a);
    color: white;
    border-radius: 16px;
}

.no-vulns-icon {
    font-size: 4rem;
    margin-bottom: 1rem;
}

.no-vulnerabilities h2 {
    font-size: 2rem;
    margin-bottom: 1rem;
}

/* === REMEDIATION === */
.remediation-summary {
    background: #f0f9ff;
    padding: 1rem;
    border-radius: 8px;
    border-left: 4px solid #0ea5e9;
    margin-bottom: 2rem;
}

.remediation-plans {
    display: grid;
    gap: 2rem;
}

.remediation-card {
    background: white;
    border: 1px solid #e5e7eb;
    border-radius: 12px;
    padding: 1.5rem;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.plan-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
}

.plan-header h3 {
    font-size: 1.25rem;
    font-weight: 600;
    color: #1f2937;
}

.priority-badge {
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
}

.priority-badge.priority-immediate {
    background: #dc2626;
    color: white;
}

.priority-badge.priority-high {
    background: #ea580c;
    color: white;
}

.priority-badge.priority-medium {
    background: #d97706;
    color: white;
}

.priority-badge.priority-low {
    background: #16a34a;
    color: white;
}

.plan-meta {
    display: flex;
    gap: 1rem;
    margin-bottom: 1.5rem;
    flex-wrap: wrap;
}

.plan-stat {
    background: #f3f4f6;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    font-size: 0.875rem;
    font-weight: 500;
}

.plan-steps {
    margin-bottom: 1.5rem;
}

.plan-steps h4 {
    font-size: 1rem;
    font-weight: 600;
    margin-bottom: 1rem;
    color: #374151;
}

.plan-steps ol {
    list-style: none;
    counter-reset: step-counter;
}

.remediation-step {
    counter-increment: step-counter;
    margin-bottom: 1rem;
    padding: 1rem;
    background: #f8fafc;
    border-radius: 8px;
    border-left: 4px solid #4f46e5;
    position: relative;
    padding-left: 3rem;
}

.remediation-step::before {
    content: counter(step-counter);
    position: absolute;
    left: 1rem;
    top: 1rem;
    background: #4f46e5;
    color: white;
    width: 1.5rem;
    height: 1.5rem;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    font-size: 0.875rem;
}

.step-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 0.5rem;
}

.step-meta {
    font-size: 0.75rem;
    color: #6b7280;
    background: #e5e7eb;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
}

.step-description {
    color: #4b5563;
    margin-bottom: 0.75rem;
}

.step-code {
    background: #f3f4f6;
    color: #374151;
    padding: 0.75rem;
    border-radius: 6px;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.8rem;
    border: 1px solid #d1d5db;
}

.risk-warning {
    background: #fef2f2;
    padding: 1rem;
    border-radius: 8px;
    border-left: 4px solid #ef4444;
    color: #991b1b;
}

.risk-warning h5 {
    font-weight: 600;
    margin-bottom: 0.5rem;
}

/* === TECHNICAL DETAILS === */
.technical-details {
    background: #f8fafc;
    border: 1px solid #e5e7eb;
    border-radius: 12px;
    overflow: hidden;
}

.details-toggle {
    background: #f1f5f9;
    padding: 1rem 1.5rem;
    cursor: pointer;
    font-weight: 600;
    color: #374151;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    border: none;
    width: 100%;
    text-align: left;
    transition: background 0.2s;
}

.details-toggle:hover {
    background: #e2e8f0;
}

.details-toggle::after {
    content: '‚ñ∂';
    margin-left: auto;
    transition: transform 0.3s;
}

.technical-details[open] .details-toggle::after {
    transform: rotate(90deg);
}

.details-content {
    padding: 1.5rem;
}

.tech-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
    margin-bottom: 1.5rem;
}

.tech-item h4 {
    font-weight: 600;
    color: #374151;
    margin-bottom: 0.75rem;
}

.tech-item ul {
    list-style: none;
    padding-left: 0;
}

.tech-item li {
    padding: 0.25rem 0;
    color: #6b7280;
}

.analysis-summary {
    background: white;
    padding: 1rem;
    border-radius: 8px;
    border: 1px solid #e5e7eb;
}

.analysis-summary h4 {
    font-weight: 600;
    color: #374151;
    margin-bottom: 0.75rem;
}

.analysis-summary pre {
    background: #f8fafc;
    padding: 1rem;
    border-radius: 6px;
    font-size: 0.875rem;
    color: #4b5563;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/* === FOOTER === */
.footer {
    background: #1f2937;
    color: white;
    padding: 2rem;
    text-align: center;
}

.footer-content p {
    margin-bottom: 0.5rem;
}

/* === RESPONSIVE DESIGN === */
@media (max-width: 768px) {
    .container {
        margin: 10px;
        border-radius: 8px;
    }
    
    .header {
        padding: 1.5rem;
    }
    
    .header h1 {
        font-size: 2rem;
    }
    
    .header-grid {
        grid-template-columns: 1fr;
    }
    
    .content {
        padding: 1.5rem;
    }
    
    .metrics-grid {
        grid-template-columns: 1fr;
    }
    
    .vuln-header {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .vuln-meta {
        grid-template-columns: 1fr;
    }
    
    .plan-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
    }
    
    .plan-meta {
        flex-direction: column;
    }
    
    .step-header {
        flex-direction: column;
        align-items: flex-start;
    }
}

/* === ANIMATIONS === */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.section {
    animation: fadeIn 0.6s ease-out;
}

/* === PRINT STYLES === */
@media print {
    body {
        background: white;
    }
    
    .container {
        box-shadow: none;
        margin: 0;
    }
    
    .header {
        background: #4f46e5 !important;
        -webkit-print-color-adjust: exact;
        color-adjust: exact;
    }
    
    .technical-details {
        border: 1px solid #ccc;
    }
    
    .details-content {
        display: block !important;
    }
    
    .details-toggle {
        display: none;
    }
    
    .vulnerability-card {
        break-inside: avoid;
        page-break-inside: avoid;
        margin-bottom: 1rem;
    }
}
</style></head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1>üõ°Ô∏è Security Analysis Report</h1>
                <div class="header-grid">
                    <div class="header-item">
                        <div class="header-label">üìÅ File</div>
                        <div class="header-value">abap_sample.json</div>
                    </div>
                    <div class="header-item">
                        <div class="header-label">üìä Total Vulnerabilities</div>
                        <div class="header-value">2</div>
                    </div>
                    <div class="header-item">
                        <div class="header-label">‚ö° High Priority</div>
                        <div class="header-value">2</div>
                    </div>
                    <div class="header-item">
                        <div class="header-label">üéØ Risk Score</div>
                        <div class="header-value">7.0/10</div>
                    </div>
                </div>
            </div>
        </header>

        <main class="content">
            <!-- Executive Summary -->
            <section class="section">
                <h2 class="section-title">üìà Executive Summary</h2>
                
                <div class="metrics-grid">
                    <div class="metric-card high">
                        <div class="metric-icon">‚ö°</div>
                        <div class="metric-value">2</div>
                        <div class="metric-label">ALTA</div>
                    </div>
                </div>

                <div class="summary-info">
                    <p><strong>Analysis completed in 31.47s</strong></p>
                    <p>ü§ñ AI-powered triage analyzed 2 vulnerabilities</p>
                </div>
            </section>

            <!-- Vulnerabilities -->
            <section class="section">
                <h2 class="section-title">üö® Security Vulnerabilities</h2>
                
                <div class="vulnerabilities-list">
                    <div class="vulnerability-card high">
                        <div class="vuln-header">
                            <h3 class="vuln-title">
                                üìÑ 1. Directory Traversal
                            </h3>
                            <div class="vuln-badges">
                                <span class="badge severity-high">
                                    ALTA
                                </span>
                                <span class="badge type-badge">Directory Traversal</span>
                            </div>
                        </div>
                        
                        <div class="vuln-body">
                            <div class="vuln-meta">
                                <div class="meta-item">
                                    <span class="meta-label">üìç Location</span>
                                    <span class="meta-value">test-code\YAL0029.TXT:679</span>
                                </div>
                                <div class="meta-item">
                                    <span class="meta-label">üÜî ID</span>
                                    <span class="meta-value">abap-directory-traversal-001</span>
                                </div>
                                <div class="meta-item">
                                    <span class="meta-label">üîó CWE</span>
                                    <span class="meta-value">
                                        <a href="https://cwe.mitre.org/data/definitions/22.html" target="_blank">
                                            CWE-22
                                        </a>
                                    </span>
                                </div>
                            </div>
                            
                            <div class="vuln-description">
                                <h4>üìù Description</h4>
                                <p>File operation with unvalidated path may allow directory traversal</p>
                            </div>
                            
                            <div class="vuln-code">
                                <h4>üíª Code Context</h4>
                                <pre class="code-block">  2 |      ELSEIF rb_ser EQ abap_true.
  3 |        CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY &#39;/&#39;.
  4 | &gt;&gt;     OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.
  5 |        IF sy-subrc EQ 0.
  6 |          lf_fich_open = abap_true.
  7 |        ELSE.</pre>
                            </div>
                            
                            <div class="vuln-remediation">
                                <h4>üí° Remediation Advice</h4>
                                <div class="advice-content">
    Prevent directory traversal:
    - Validate file paths using FILE_VALIDATE_NAME
    - Use absolute paths with proper validation
    - Implement allowlist for accessible directories
    - Check sy-subrc after FILE_VALIDATE_NAME call
    
    Example:
    CALL FUNCTION &#39;FILE_VALIDATE_NAME&#39;
      EXPORTING logical_filename = file_path
      EXCEPTIONS OTHERS = 1.
    IF sy-subrc = 0.
      &#34; Safe to use file_path
    ENDIF.
    </div>
                            </div>
                        </div>
                    </div>
                    <div class="vulnerability-card high">
                        <div class="vuln-header">
                            <h3 class="vuln-title">
                                üìÑ 2. Directory Traversal
                            </h3>
                            <div class="vuln-badges">
                                <span class="badge severity-high">
                                    ALTA
                                </span>
                                <span class="badge type-badge">Directory Traversal</span>
                            </div>
                        </div>
                        
                        <div class="vuln-body">
                            <div class="vuln-meta">
                                <div class="meta-item">
                                    <span class="meta-label">üìç Location</span>
                                    <span class="meta-value">test-code\YAL0029.TXT:780</span>
                                </div>
                                <div class="meta-item">
                                    <span class="meta-label">üÜî ID</span>
                                    <span class="meta-value">abap-directory-traversal-001</span>
                                </div>
                                <div class="meta-item">
                                    <span class="meta-label">üîó CWE</span>
                                    <span class="meta-value">
                                        <a href="https://cwe.mitre.org/data/definitions/22.html" target="_blank">
                                            CWE-22
                                        </a>
                                    </span>
                                </div>
                            </div>
                            
                            <div class="vuln-description">
                                <h4>üìù Description</h4>
                                <p>File operation with unvalidated path may allow directory traversal</p>
                            </div>
                            
                            <div class="vuln-code">
                                <h4>üíª Code Context</h4>
                                <pre class="code-block">  2 |          IF sy-subrc EQ 0.
  3 |    *       Si la compresion ha ido bien, se borra el fichero original
  4 | &gt;&gt;         DELETE DATASET ld_path.
  5 |          ENDIF.
  6 |        ENDIF.
  7 |      ENDIF.</pre>
                            </div>
                            
                            <div class="vuln-remediation">
                                <h4>üí° Remediation Advice</h4>
                                <div class="advice-content">
    Prevent directory traversal:
    - Validate file paths using FILE_VALIDATE_NAME
    - Use absolute paths with proper validation
    - Implement allowlist for accessible directories
    - Check sy-subrc after FILE_VALIDATE_NAME call
    
    Example:
    CALL FUNCTION &#39;FILE_VALIDATE_NAME&#39;
      EXPORTING logical_filename = file_path
      EXCEPTIONS OTHERS = 1.
    IF sy-subrc = 0.
      &#34; Safe to use file_path
    ENDIF.
    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Remediation Plans -->
            <section class="section">
                <h2 class="section-title">üõ†Ô∏è Remediation Plans</h2>
                
                <div class="remediation-summary">
                    <p>2 actionable remediation plans generated, prioritized by risk and complexity.</p>
                </div>
                
                <div class="remediation-plans">
                    <div class="remediation-card">
                        <div class="plan-header">
                            <h3>üîß Directory Traversal</h3>
                            <span class="priority-badge priority-high">
                                HIGH
                            </span>
                        </div>
                        
							<div class="plan-meta">
								<span class="plan-stat">üìä Complexity: 8.25/10</span>
								<span class="plan-stat">üìã 2 steps</span>
							</div>

                        <div class="plan-steps">
                            <h4>Implementation Steps:</h4>
                            <ol>
                                <li class="remediation-step">
                                    <div class="step-header">
                                        <strong>Validate and Sanitize File Paths</strong>
                                        <span class="step-meta">45min ‚Ä¢ medium</span>
                                    </div>
                                    <div class="step-description">To prevent directory traversal attacks, it&#39;s crucial to validate and sanitize file paths before using them in file operations. This can be achieved by checking if the provided path is within the expected directory and ensuring it doesn&#39;t contain any malicious characters or sequences that could lead to accessing unauthorized files or directories. The principle here is to ensure that the application only accesses files and directories that are intended to be accessible, thereby preventing an attacker from manipulating the path to access sensitive data. This step involves implementing a function that checks the path for any traversal attempts (like ../) and ensures the path is absolute and within the allowed directory structure.</div>
                                    <pre class="step-code">BEFORE:
CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY &#39;/&#39;.
OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.

AFTER:
DATA: lv_allowed_path TYPE string.
lv_allowed_path =...</pre>
                                </li>
                                <li class="remediation-step">
                                    <div class="step-header">
                                        <strong>Implement Directory Traversal Protection</strong>
                                        <span class="step-meta">60min ‚Ä¢ hard</span>
                                    </div>
                                    <div class="step-description">This step involves protecting against directory traversal by ensuring that any file operation is restricted to a specific directory and its subdirectories. This can be achieved by prefixing the file path with a base directory that is known to be safe and then validating the resulting path to ensure it does not attempt to traverse outside this base directory. The security principle here is to restrict access to only those resources that are necessary for the application&#39;s functionality, thereby reducing the attack surface. Implementing this protection requires modifying the file operation code to include path validation and ensuring that all file paths used in the application are absolute and sanitized.</div>
                                    <pre class="step-code">BEFORE:
DELETE DATASET ld_path.

AFTER:
DATA: lv_base_path TYPE string.
lv_base_path = &#39;/safe/base/directory/&#39;.
IF ld_path CS lv_base_path.
  DELETE DATASET ld_path.
ENDIF.</pre>
                                </li>
                            </ol>
                        </div>
                        
                        <div class="risk-warning">
                            <h5>‚ö†Ô∏è Risk if not addressed:</h5>
                            <p>CONCRETE IMPACT: An attacker could exploit directory traversal vulnerabilities to access sensitive files or directories, potentially leading to data breaches or system compromise. This could result in significant financial and reputational damage, as well as potential compliance violations.</p>
                        </div>
                    </div>
                    <div class="remediation-card">
                        <div class="plan-header">
                            <h3>üîß Directory Traversal</h3>
                            <span class="priority-badge priority-high">
                                HIGH
                            </span>
                        </div>
                        
							<div class="plan-meta">
								<span class="plan-stat">üìä Complexity: 8.25/10</span>
								<span class="plan-stat">üìã 2 steps</span>
							</div>

                        <div class="plan-steps">
                            <h4>Implementation Steps:</h4>
                            <ol>
                                <li class="remediation-step">
                                    <div class="step-header">
                                        <strong>Validate and Sanitize File Paths</strong>
                                        <span class="step-meta">45min ‚Ä¢ medium</span>
                                    </div>
                                    <div class="step-description">To prevent directory traversal attacks, it&#39;s crucial to validate and sanitize file paths before using them in file operations. This can be achieved by checking if the provided path is within the expected directory and ensuring it doesn&#39;t contain any malicious characters or sequences that could lead to accessing unauthorized files or directories. The principle here is to ensure that the application only accesses files and directories that are intended to be accessible, thereby preventing an attacker from manipulating the path to access sensitive data. This step involves implementing a function that checks the path for any traversal attempts (like ../) and ensures the path is absolute and within the allowed directory structure.</div>
                                    <pre class="step-code">BEFORE:
CONCATENATE p_path p_nfich INTO ld_path SEPARATED BY &#39;/&#39;.
OPEN DATASET ld_path FOR OUTPUT IN TEXT MODE ENCODING UTF-8.

AFTER:
DATA: lv_allowed_path TYPE string.
lv_allowed_path =...</pre>
                                </li>
                                <li class="remediation-step">
                                    <div class="step-header">
                                        <strong>Implement Directory Traversal Protection</strong>
                                        <span class="step-meta">60min ‚Ä¢ hard</span>
                                    </div>
                                    <div class="step-description">This step involves protecting against directory traversal by ensuring that any file operation is restricted to a specific directory and its subdirectories. This can be achieved by prefixing the file path with a base directory that is known to be safe and then validating the resulting path to ensure it does not attempt to traverse outside this base directory. The security principle here is to restrict access to only those resources that are necessary for the application&#39;s functionality, thereby reducing the attack surface. Implementing this protection requires modifying the file operation code to include path validation and ensuring that all file paths used in the application are absolute and sanitized.</div>
                                    <pre class="step-code">BEFORE:
DELETE DATASET ld_path.

AFTER:
DATA: lv_base_path TYPE string.
lv_base_path = &#39;/safe/base/directory/&#39;.
IF ld_path CS lv_base_path.
  DELETE DATASET ld_path.
ENDIF.</pre>
                                </li>
                            </ol>
                        </div>
                        
                        <div class="risk-warning">
                            <h5>‚ö†Ô∏è Risk if not addressed:</h5>
                            <p>CONCRETE IMPACT: An attacker could exploit directory traversal vulnerabilities to access sensitive files or directories, potentially leading to data breaches or system compromise. This could result in significant financial and reputational damage, as well as potential compliance violations.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Technical Details -->
            <section class="section">
                <details class="technical-details">
                    <summary class="details-toggle">üîç Technical Analysis Details</summary>
                    <div class="details-content">
                        <div class="tech-grid">
                            <div class="tech-item">
                                <h4>üìä Analysis Statistics</h4>
                                <ul>
                                    <li>Processing time: 31.47s</li>
                                    <li>File size: 3.67 KB</li>
                                    <li>Language: Auto-detected</li>
                                    <li>Chunking: Disabled</li>
                                </ul>
                            </div>
                            
                            <div class="tech-item">
                                <h4>ü§ñ LLM Triage Results</h4>
                                <ul>
                                    <li>Confirmed vulnerabilities: 2</li>
                                    <li>False positives: 0</li>
                                    <li>Need manual review: 0</li>
                                    <li>Analysis time: 2.10s</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="analysis-summary">
                            <h4>üìã Analysis Summary</h4>
                            <pre>Se han detectado dos vulnerabilidades de Directory Traversal en el c√≥digo, ambas con una severidad alta. Es importante abordar estas vulnerabilidades para prevenir posibles ataques de directory traversal.</pre>
                        </div>
                    </div>
                </details>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <p>Generated by <strong>Security Analysis Platform v3.0</strong> on 2025-12-16 at 11:17:57</p>
                <p>For questions about this report, contact your security team.</p>
            </div>
        </footer>
    </div>

<!-- adapters/output/templates/scripts.html -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('üõ°Ô∏è Security Analysis Report v3.0 loaded');
    
    // Enhanced interactivity
    initializeAnimations();
    setupCopyFunctionality();
    setupSearchFunctionality();
    setupKeyboardNavigation();
    
    // Report statistics
    logReportStatistics();
});

function initializeAnimations() {
    // Intersection Observer for scroll animations
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver(function(entries) {
        entries.forEach(function(entry) {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, observerOptions);

    // Apply to vulnerability cards
    document.querySelectorAll('.vulnerability-card, .remediation-card').forEach(function(el) {
        el.style.opacity = '0';
        el.style.transform = 'translateY(20px)';
        el.style.transition = 'opacity 0.6s ease-out, transform 0.6s ease-out';
        observer.observe(el);
    });
}

function setupCopyFunctionality() {
    // Add copy buttons to vulnerability IDs and CWE links
    document.querySelectorAll('.meta-value').forEach(function(element) {
        const text = element.textContent.trim();
        
        if (text.match(/^(VULN-|ABAP-|CWE-)/)) {
            element.style.cursor = 'pointer';
            element.title = 'Click to copy ' + text;
            
            element.addEventListener('click', function() {
                copyToClipboard(text);
                showToast('‚úÖ Copied: ' + text);
            });
        }
    });
}

function setupSearchFunctionality() {
    // Create search box
    const searchBox = document.createElement('div');
    searchBox.innerHTML = `
        <div style="position: fixed; top: 20px; right: 20px; z-index: 1000; background: white; padding: 10px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
            <input type="text" id="vulnerabilitySearch" placeholder="üîç Search vulnerabilities..." 
                   style="border: 1px solid #ddd; padding: 8px; border-radius: 4px; width: 250px;">
        </div>
    `;
    document.body.appendChild(searchBox);
    
    const searchInput = document.getElementById('vulnerabilitySearch');
    searchInput.addEventListener('input', function(e) {
        const query = e.target.value.toLowerCase();
        filterVulnerabilities(query);
    });
}

function setupKeyboardNavigation() {
    document.addEventListener('keydown', function(e) {
        // Ctrl+F or Cmd+F to focus search
        if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
            e.preventDefault();
            const searchInput = document.getElementById('vulnerabilitySearch');
            if (searchInput) {
                searchInput.focus();
            }
        }
        
        // Escape to clear search
        if (e.key === 'Escape') {
            const searchInput = document.getElementById('vulnerabilitySearch');
            if (searchInput && searchInput === document.activeElement) {
                searchInput.value = '';
                filterVulnerabilities('');
                searchInput.blur();
            }
        }
    });
}

function filterVulnerabilities(query) {
    const cards = document.querySelectorAll('.vulnerability-card');
    let visibleCount = 0;
    
    cards.forEach(function(card) {
        const text = card.textContent.toLowerCase();
        const isVisible = query === '' || text.includes(query);
        
        card.style.display = isVisible ? 'block' : 'none';
        if (isVisible) visibleCount++;
    });
    
    // Update search results indicator
    updateSearchResults(visibleCount, cards.length, query);
}

function updateSearchResults(visible, total, query) {
    let indicator = document.getElementById('searchResults');
    
    if (!indicator) {
        indicator = document.createElement('div');
        indicator.id = 'searchResults';
        indicator.style.cssText = `
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #4f46e5;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.875rem;
            z-index: 1000;
            transition: opacity 0.3s;
        `;
        document.body.appendChild(indicator);
    }
    
    if (query) {
        indicator.textContent = `Found ${visible} of ${total} vulnerabilities`;
        indicator.style.opacity = '1';
    } else {
        indicator.style.opacity = '0';
    }
}

function copyToClipboard(text) {
    if (navigator.clipboard) {
        navigator.clipboard.writeText(text).catch(function() {
            fallbackCopy(text);
        });
    } else {
        fallbackCopy(text);
    }
}

function fallbackCopy(text) {
    const textArea = document.createElement('textarea');
    textArea.value = text;
    textArea.style.position = 'fixed';
    textArea.style.left = '-9999px';
    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();
    
    try {
        document.execCommand('copy');
    } catch (err) {
        console.warn('Copy failed:', err);
    }
    
    document.body.removeChild(textArea);
}

function showToast(message) {
    const toast = document.createElement('div');
    toast.textContent = message;
    toast.style.cssText = `
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: #10b981;
        color: white;
        padding: 12px 20px;
        border-radius: 8px;
        z-index: 9999;
        animation: slideInDown 0.3s ease-out;
        font-weight: 500;
    `;
    
    document.body.appendChild(toast);
    
    setTimeout(function() {
        toast.style.animation = 'slideOutUp 0.3s ease-out';
        setTimeout(function() {
            document.body.removeChild(toast);
        }, 300);
    }, 2000);
}

function logReportStatistics() {
    const stats = {
        totalVulnerabilities: 2,
        highPriority: 2,
        riskScore: 7.0,
        processingTime: '31.47s',
        chunking: false,
        llmAnalysis: true,
        reportVersion: '3.0'
    };
    
    console.log('üìä Report Statistics:', stats);
    
    // Performance metrics
    console.log('‚ö° Performance Metrics:');
    console.log('  ‚Ä¢ DOM Ready:', performance.now().toFixed(2) + 'ms');
    console.log('  ‚Ä¢ Interactive elements:', document.querySelectorAll('[onclick], [data-action]').length);
    console.log('  ‚Ä¢ Vulnerability cards:', document.querySelectorAll('.vulnerability-card').length);
}

// CSS animations for toasts
const additionalStyles = `
@keyframes slideInDown {
    from {
        opacity: 0;
        transform: translate(-50%, -100%);
    }
    to {
        opacity: 1;
        transform: translate(-50%, 0);
    }
}

@keyframes slideOutUp {
    from {
        opacity: 1;
        transform: translate(-50%, 0);
    }
    to {
        opacity: 0;
        transform: translate(-50%, -100%);
    }
}
`;

const styleSheet = document.createElement('style');
styleSheet.textContent = additionalStyles;
document.head.appendChild(styleSheet);
</script></body>
</html>